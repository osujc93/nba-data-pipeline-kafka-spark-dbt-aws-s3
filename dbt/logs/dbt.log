{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "bfbf9d2c-f081-4c6b-b465-46c17d1c77c6", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2025-04-25T01:40:23.929434Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "bfbf9d2c-f081-4c6b-b465-46c17d1c77c6", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2025-04-25T01:40:23.949249Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "80c3c517-9b1c-4cf4-ad0f-b4269f323166", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2025-04-25T02:38:47.771676Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "80c3c517-9b1c-4cf4-ad0f-b4269f323166", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'json', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2025-04-25T02:38:47.793676Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:42.787144Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt deps", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'json', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:42.800914Z"}}
{"data": {"path": "/tmp/dbt-downloads-xbt29c8x"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-xbt29c8x'", "name": "DepsSetDownloadDirectory", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:45.863570Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:45.868032Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.201692Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.208006Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.323562Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json", "name": "RegistryProgressGETRequest", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.349666Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200", "name": "RegistryProgressGETResponse", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.490790Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/calogica/dbt_date.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json", "name": "RegistryProgressGETRequest", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.512304Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/calogica/dbt_date.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200", "name": "RegistryProgressGETResponse", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.611728Z"}}
{"data": {"new_name": "godatadriven/dbt_date", "old_name": "calogica/dbt_date"}, "info": {"category": "", "code": "D001", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Deprecated functionality\nThe `calogica/dbt_date` package is deprecated in favor of\n`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use\n`godatadriven/dbt_date` instead.", "name": "PackageRedirectDeprecation", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.618581Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:34:46.635938Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:01.062617Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:01.066333Z"}}
{"data": {"package_name": "metaplane/dbt_expectations"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Installing metaplane/dbt_expectations", "name": "DepsStartPackageInstall", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:01.070560Z"}}
{"data": {"version_name": "version 0.10.4"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Installed from version 0.10.4", "name": "DepsInstallInfo", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:07.838393Z"}}
{"data": {"version_latest": "0.10.8"}, "info": {"category": "", "code": "M016", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Updated version available: 0.10.8", "name": "DepsUpdateAvailable", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:07.844378Z"}}
{"data": {"package_name": "calogica/dbt_date"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Installing calogica/dbt_date", "name": "DepsStartPackageInstall", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:07.848400Z"}}
{"data": {"version_name": "version 0.10.1"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Installed from version 0.10.1", "name": "DepsInstallInfo", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.401938Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.405974Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "", "name": "Formatting", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.410807Z"}}
{"data": {"packages": ["metaplane/dbt_expectations"]}, "info": {"category": "", "code": "M019", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "info", "msg": "Updates available for packages: ['metaplane/dbt_expectations']                 \nUpdate your versions in packages.yml, then run dbt deps", "name": "DepsNotifyUpdatesAvailable", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.416181Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 31.767504, "process_in_blocks": "272", "process_kernel_time": 2.672376, "process_mem_max_rss": "101132", "process_out_blocks": "7568", "process_user_time": 4.754017}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 31.767504, \"process_in_blocks\": \"272\", \"process_kernel_time\": 2.672376, \"process_mem_max_rss\": \"101132\", \"process_out_blocks\": \"7568\", \"process_user_time\": 4.754017}", "name": "ResourceReport", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.428941Z"}}
{"data": {"command": "dbt deps", "completed_at": "2025-04-25T12:35:12.435147Z", "elapsed": 31.775915, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Command `dbt deps` succeeded at 12:35:12.435147 after 31.78 seconds", "name": "CommandCompleted", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.435898Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "86d1f156-77f0-499c-a8b7-3166f25729d4", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1279, "thread": "MainThread", "ts": "2025-04-25T12:35:12.441951Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:39:47.641061Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:39:47.660935Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:39:49.094885Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:39:49.697367Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:02.313731Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:02.336105Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.710642Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.726354Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.798525Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.807078Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.811448Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.816253Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:04.821661Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:04.827349Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:04.957591Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:04.962116Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:04.966308Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:04.970256Z"}}
{"data": {"elapsed": 4.1581254, "query_id": "20250425_034902_00000_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "SQL status: SUCCESS in 4.158 seconds", "name": "SQLQueryStatus", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:09.124440Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 1386, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:40:09.131379Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:09.156447Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:09.160197Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:09.254454Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:09.257437Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:09.260864Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:09.264728Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:09.269350Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:09.273475Z"}}
{"data": {"elapsed": 3.7472587, "query_id": "20250425_034906_00001_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "SQL status: SUCCESS in 3.747 seconds", "name": "SQLQueryStatus", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:13.016699Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:13.026127Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 1386, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:40:13.031419Z"}}
{"data": {"elapsed": 3.7917616, "query_id": "20250425_034906_00002_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "SQL status: SUCCESS in 3.792 seconds", "name": "SQLQueryStatus", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:13.065372Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:13.079718Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1386, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:40:13.088010Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.101126Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.130699Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.135400Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.149212Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.155791Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.221238Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:12.052869Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:12.077847Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:12.482980Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:12.607154Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- Initial (full) creation for a non-incremental run:\n-------------------------------------------------------------------\nCREATE TABLE \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" AS\nSELECT *\nFROM final_data"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- Initial (full) creation for a non-incremental run:\n-------------------------------------------------------------------\nCREATE TABLE \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" AS\nSELECT *\nFROM final_data", "name": "SQLQuery", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:12.613228Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:12.621610Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250425_034911_00003_rjdrs", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Trino adapter: Trino query id: 20250425_034911_00003_rjdrs", "name": "AdapterEventDebug", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.096204Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)", "name": "AdapterEventDebug", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.101259Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.107044Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.113054Z"}}
{"data": {"exc": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 614, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 131, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 76, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "CatchableExceptionOnRun", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.132749Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": -0.009253979, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:40:13.139151", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[31mERROR\u001b[0m in -0.01s]", "name": "LogModelResult", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.147562Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:40:13.139151", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:40:13.130276", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {}, "execution_time": -0.009253979, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:40:12.076972Z", "name": "compile", "started_at": "2025-04-25T12:40:13.162381Z"}, {"completed_at": "2025-04-25T12:40:13.106104Z", "name": "execute", "started_at": "2025-04-25T12:40:12.083060Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 1386, "thread": "Thread-1", "ts": "2025-04-25T12:40:13.153786Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": -0.009253979, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:40:12.076972Z", "name": "compile", "started_at": "2025-04-25T12:40:13.162381Z"}, {"completed_at": "2025-04-25T12:40:13.106104Z", "name": "execute", "started_at": "2025-04-25T12:40:12.083060Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.scd_player_boxscores' to be skipped because of status 'error'.  Reason: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql.", "name": "MarkSkippedChildren", "pid": 1386, "thread": "Thread-7", "ts": "2025-04-25T12:40:13.161534Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts  [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.169311Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.scd_player_boxscores ................. [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.179704Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.185601Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.190850Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.198442Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.205172Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.209385Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.215308Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.221424Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 8.40 seconds", "execution_time": 8.400335, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 8.40 seconds (8.40s).", "name": "FinishedRunningStats", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.226055Z"}}
{"data": {"elapsed_time": 8.400335, "generated_at": "2025-04-25T12:40:13Z", "results": [{"adapter_response": {}, "execution_time": -0.009253979, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:40:12.076972Z", "name": "compile", "started_at": "2025-04-25T12:40:13.162381Z"}, {"completed_at": "2025-04-25T12:40:13.106104Z", "name": "execute", "started_at": "2025-04-25T12:40:12.083060Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.233034Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.635256Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.658563Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.717440Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.724688Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.742020Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.750363Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_034911_00003_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.758770Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "", "name": "Formatting", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.764656Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.770701Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 28.195122, "process_in_blocks": "208", "process_kernel_time": 1.512635, "process_mem_max_rss": "127188", "process_out_blocks": "96", "process_user_time": 9.656129}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 28.195122, \"process_in_blocks\": \"208\", \"process_kernel_time\": 1.512635, \"process_mem_max_rss\": \"127188\", \"process_out_blocks\": \"96\", \"process_user_time\": 9.656129}", "name": "ResourceReport", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.778889Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T12:40:13.787277Z", "elapsed": 28.206753, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Command `dbt run` failed at 12:40:13.787277 after 28.21 seconds", "name": "CommandCompleted", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.788361Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "d2f787de-d58a-4c5c-878f-5b25d7eb69d0", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1386, "thread": "MainThread", "ts": "2025-04-25T12:40:13.794578Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:19.307734Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:19.328565Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:20.628006Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:21.076454Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:30.530255Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:30.535400Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.363494Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.381607Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.458641Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.476370Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.482962Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.491719Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:32.498916Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:32.511181Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:32.789774Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:32.795137Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:32.808088Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:32.815420Z"}}
{"data": {"elapsed": 0.28676456, "query_id": "20250425_035348_00004_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "SQL status: SUCCESS in 0.287 seconds", "name": "SQLQueryStatus", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:33.094667Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 1514, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:44:33.103134Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:33.138675Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:33.143008Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:33.231765Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:33.240777Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:33.243647Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:33.249570Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:33.253999Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:33.262731Z"}}
{"data": {"elapsed": 0.81367123, "query_id": "20250425_035348_00005_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "SQL status: SUCCESS in 0.814 seconds", "name": "SQLQueryStatus", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:34.067540Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:34.074427Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 1514, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:44:34.080591Z"}}
{"data": {"elapsed": 0.8418531, "query_id": "20250425_035348_00006_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "SQL status: SUCCESS in 0.842 seconds", "name": "SQLQueryStatus", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:34.104783Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:34.112113Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1514, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:44:34.117483Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:34.137014Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.150038Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.155808Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.161830Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.166572Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.207996Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.518465Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.549514Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:34.974446Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.090693Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- Initial (full) creation for a non-incremental run:\n-------------------------------------------------------------------\nCREATE TABLE \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" AS\nSELECT *\nFROM final_data"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- Initial (full) creation for a non-incremental run:\n-------------------------------------------------------------------\nCREATE TABLE \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" AS\nSELECT *\nFROM final_data", "name": "SQLQuery", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.096597Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.103149Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250425_035350_00007_rjdrs", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Trino adapter: Trino query id: 20250425_035350_00007_rjdrs", "name": "AdapterEventDebug", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.164537Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)", "name": "AdapterEventDebug", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.170433Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.175281Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.180316Z"}}
{"data": {"exc": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 614, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 131, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 76, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "CatchableExceptionOnRun", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.192022Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": 1.039911, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:44:35.201187", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[31mERROR\u001b[0m in 1.04s]", "name": "LogModelResult", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.208292Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:44:35.201187", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:44:34.149544", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {}, "execution_time": 1.039911, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:44:34.548728Z", "name": "compile", "started_at": "2025-04-25T12:44:34.170867Z"}, {"completed_at": "2025-04-25T12:44:35.174657Z", "name": "execute", "started_at": "2025-04-25T12:44:34.555099Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 1514, "thread": "Thread-1", "ts": "2025-04-25T12:44:35.213480Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 1.039911, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:44:34.548728Z", "name": "compile", "started_at": "2025-04-25T12:44:34.170867Z"}, {"completed_at": "2025-04-25T12:44:35.174657Z", "name": "execute", "started_at": "2025-04-25T12:44:34.555099Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.scd_player_boxscores' to be skipped because of status 'error'.  Reason: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql.", "name": "MarkSkippedChildren", "pid": 1514, "thread": "Thread-7", "ts": "2025-04-25T12:44:35.223288Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts  [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.234180Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.scd_player_boxscores ................. [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.241322Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.245709Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.250888Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.257807Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.263253Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.268848Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.277143Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.282994Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 2.79 seconds", "execution_time": 2.785309, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 2.79 seconds (2.79s).", "name": "FinishedRunningStats", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.288441Z"}}
{"data": {"elapsed_time": 2.785309, "generated_at": "2025-04-25T12:44:35Z", "results": [{"adapter_response": {}, "execution_time": 1.039911, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:44:34.548728Z", "name": "compile", "started_at": "2025-04-25T12:44:34.170867Z"}, {"completed_at": "2025-04-25T12:44:35.174657Z", "name": "execute", "started_at": "2025-04-25T12:44:34.555099Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.297964Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.599616Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.617481Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.653713Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.658960Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.663986Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.669549Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 382:1: mismatched input 'CREATE'. Expecting: '(', 'SELECT', 'TABLE', 'VALUES'\", query_id=20250425_035350_00007_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.674193Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "", "name": "Formatting", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.679321Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.686843Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 18.672482, "process_in_blocks": "16", "process_kernel_time": 1.475518, "process_mem_max_rss": "127748", "process_out_blocks": "8", "process_user_time": 8.730934}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 18.672482, \"process_in_blocks\": \"16\", \"process_kernel_time\": 1.475518, \"process_mem_max_rss\": \"127748\", \"process_out_blocks\": \"8\", \"process_user_time\": 8.730934}", "name": "ResourceReport", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.693278Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T12:44:35.698652Z", "elapsed": 18.67881, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Command `dbt run` failed at 12:44:35.698652 after 18.68 seconds", "name": "CommandCompleted", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.699194Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "82ce8a4d-0d1d-41bd-8b6b-3b1df56f1e64", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1514, "thread": "MainThread", "ts": "2025-04-25T12:44:35.704548Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:06.329672Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:06.343711Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:07.538421Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:08.239146Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:17.176651Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:17.182180Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:18.990537Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:19.006343Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:19.054672Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:19.063299Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:19.068066Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:19.078989Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:19.094220Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.106637Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.254858Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.259392Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.262932Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.267460Z"}}
{"data": {"elapsed": 0.15758616, "query_id": "20250425_035853_00008_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "SQL status: SUCCESS in 0.158 seconds", "name": "SQLQueryStatus", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.420516Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 1646, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:49:19.427162Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores)", "name": "ConnectionReused", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:19.453293Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "NewConnection", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:19.456064Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:19.547661Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:19.549747Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:19.553998Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:19.557802Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:19.561871Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:19.565787Z"}}
{"data": {"elapsed": 0.5152629, "query_id": "20250425_035853_00010_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "SQL status: SUCCESS in 0.515 seconds", "name": "SQLQueryStatus", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:20.081097Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:20.088451Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 1646, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:49:20.095184Z"}}
{"data": {"elapsed": 0.5466318, "query_id": "20250425_035853_00009_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "SQL status: SUCCESS in 0.547 seconds", "name": "SQLQueryStatus", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:20.108599Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:20.116037Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1646, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:49:20.120139Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:20.129636Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.142859Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.148319Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.153103Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.158010Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.203317Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.518585Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.541132Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:20.876944Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.019396Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- For the initial (non-incremental) run, just SELECT. dbt will\n-- convert it into CREATE TABLE ... AS SELECT behind the scenes.\n-------------------------------------------------------------------\nSELECT *\nFROM final_data"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- For the initial (non-incremental) run, just SELECT. dbt will\n-- convert it into CREATE TABLE ... AS SELECT behind the scenes.\n-------------------------------------------------------------------\nSELECT *\nFROM final_data", "name": "SQLQuery", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.025843Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.033881Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250425_035855_00011_rjdrs", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Trino adapter: Trino query id: 20250425_035855_00011_rjdrs", "name": "AdapterEventDebug", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.089423Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)", "name": "AdapterEventDebug", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.093932Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.098895Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.103380Z"}}
{"data": {"exc": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 614, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 131, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 76, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "CatchableExceptionOnRun", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.114240Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": 0.96717453, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:49:21.119540", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[31mERROR\u001b[0m in 0.97s]", "name": "LogModelResult", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.124900Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:49:21.119540", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:49:20.141985", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {}, "execution_time": 0.96717453, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:49:20.540647Z", "name": "compile", "started_at": "2025-04-25T12:49:20.162070Z"}, {"completed_at": "2025-04-25T12:49:21.098337Z", "name": "execute", "started_at": "2025-04-25T12:49:20.546492Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 1646, "thread": "Thread-1", "ts": "2025-04-25T12:49:21.129873Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 0.96717453, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:49:20.540647Z", "name": "compile", "started_at": "2025-04-25T12:49:20.162070Z"}, {"completed_at": "2025-04-25T12:49:21.098337Z", "name": "execute", "started_at": "2025-04-25T12:49:20.546492Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.scd_player_boxscores' to be skipped because of status 'error'.  Reason: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql.", "name": "MarkSkippedChildren", "pid": 1646, "thread": "Thread-7", "ts": "2025-04-25T12:49:21.135208Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.scd_player_boxscores ................. [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.145252Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts  [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.150290Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.155464Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.161487Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.166321Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.170462Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.174639Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.179812Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.183931Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 2.09 seconds", "execution_time": 2.0905488, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 2.09 seconds (2.09s).", "name": "FinishedRunningStats", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.187694Z"}}
{"data": {"elapsed_time": 2.0905488, "generated_at": "2025-04-25T12:49:21Z", "results": [{"adapter_response": {}, "execution_time": 0.96717453, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:49:20.540647Z", "name": "compile", "started_at": "2025-04-25T12:49:20.162070Z"}, {"completed_at": "2025-04-25T12:49:21.098337Z", "name": "execute", "started_at": "2025-04-25T12:49:20.546492Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.194721Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.454970Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.473805Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.505616Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.510340Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.514658Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.519343Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_035855_00011_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.523829Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "", "name": "Formatting", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.528548Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.533066Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.323965, "process_in_blocks": "0", "process_kernel_time": 1.244107, "process_mem_max_rss": "127276", "process_out_blocks": "8", "process_user_time": 8.848015}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 17.323965, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.244107, \"process_mem_max_rss\": \"127276\", \"process_out_blocks\": \"8\", \"process_user_time\": 8.848015}", "name": "ResourceReport", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.538341Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T12:49:21.542572Z", "elapsed": 17.32898, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Command `dbt run` failed at 12:49:21.542572 after 17.33 seconds", "name": "CommandCompleted", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.543025Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "16409d07-d0f9-4973-8f93-710e2f35d8c9", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1646, "thread": "MainThread", "ts": "2025-04-25T12:49:21.547504Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:54:47.579313Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'True', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:54:47.592794Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:54:48.641428Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:54:49.132185Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:00.091244Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:00.096582Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.103196Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.118178Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.167041Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.174644Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.178927Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.183295Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:02.187915Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.193574Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.301689Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.306367Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.311252Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.314839Z"}}
{"data": {"elapsed": 0.20917821, "query_id": "20250425_040459_00012_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "SQL status: SUCCESS in 0.209 seconds", "name": "SQLQueryStatus", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.520376Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 1779, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T12:55:02.528646Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores)", "name": "ConnectionReused", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:02.554799Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "NewConnection", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:02.558805Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:02.653785Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:02.660990Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:02.665746Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:02.669746Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:02.673611Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:02.677644Z"}}
{"data": {"elapsed": 0.59831697, "query_id": "20250425_040459_00014_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "SQL status: SUCCESS in 0.598 seconds", "name": "SQLQueryStatus", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:03.276157Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:03.285997Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 1779, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T12:55:03.296218Z"}}
{"data": {"elapsed": 0.6801514, "query_id": "20250425_040459_00013_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "SQL status: SUCCESS in 0.680 seconds", "name": "SQLQueryStatus", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:03.353798Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:03.362831Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1779, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T12:55:03.367731Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:03.382677Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.394562Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.400120Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.404226Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.409107Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.465957Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.918999Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:03.938041Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.266041Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.368442Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- For the initial (non-incremental) run, just SELECT. dbt will\n-- convert it into CREATE TABLE ... AS SELECT behind the scenes.\n-------------------------------------------------------------------\nSELECT *\nFROM final_data"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: NBA_models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-------------------------------------------------------------------\n-- For the initial (non-incremental) run, just SELECT. dbt will\n-- convert it into CREATE TABLE ... AS SELECT behind the scenes.\n-------------------------------------------------------------------\nSELECT *\nFROM final_data", "name": "SQLQuery", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.373124Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.380870Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250425_040501_00015_rjdrs", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Trino adapter: Trino query id: 20250425_040501_00015_rjdrs", "name": "AdapterEventDebug", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.423474Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)", "name": "AdapterEventDebug", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.428400Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.433108Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.437678Z"}}
{"data": {"exc": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 614, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 131, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 76, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "CatchableExceptionOnRun", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.448633Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": 1.0541983, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:55:04.457929", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[31mERROR\u001b[0m in 1.05s]", "name": "LogModelResult", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.466960Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T12:55:04.457929", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T12:55:03.394002", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {}, "execution_time": 1.0541983, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:55:03.937430Z", "name": "compile", "started_at": "2025-04-25T12:55:03.413858Z"}, {"completed_at": "2025-04-25T12:55:04.432669Z", "name": "execute", "started_at": "2025-04-25T12:55:03.942436Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 1779, "thread": "Thread-1", "ts": "2025-04-25T12:55:04.474923Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 1.0541983, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:55:03.937430Z", "name": "compile", "started_at": "2025-04-25T12:55:03.413858Z"}, {"completed_at": "2025-04-25T12:55:04.432669Z", "name": "execute", "started_at": "2025-04-25T12:55:03.942436Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.scd_player_boxscores' to be skipped because of status 'error'.  Reason: Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql.", "name": "MarkSkippedChildren", "pid": 1779, "thread": "Thread-7", "ts": "2025-04-25T12:55:04.482480Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.scd_player_boxscores ................. [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.489112Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts  [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.493141Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.498781Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.503908Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.509604Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.515851Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.521493Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.526230Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.530370Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 2.34 seconds", "execution_time": 2.3429265, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 2.34 seconds (2.34s).", "name": "FinishedRunningStats", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.534925Z"}}
{"data": {"elapsed_time": 2.3429265, "generated_at": "2025-04-25T12:55:04Z", "results": [{"adapter_response": {}, "execution_time": 1.0541983, "message": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T12:55:03.937430Z", "name": "compile", "started_at": "2025-04-25T12:55:03.413858Z"}, {"completed_at": "2025-04-25T12:55:04.432669Z", "name": "execute", "started_at": "2025-04-25T12:55:03.942436Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.540455Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.898602Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.913732Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.945290Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.951077Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.956503Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.961523Z"}}
{"data": {"msg": "Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "error", "msg": "  Database Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message=\"line 384:16: mismatched input '<EOF>'. Expecting: ')', ',', '.', 'AS', 'CROSS', 'EXCEPT', 'FETCH', 'FOR', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', <identifier>\", query_id=20250425_040501_00015_rjdrs)\n  compiled code at target/run/nba_team_stats_project/NBA_models/scd_player_boxscores.sql", "name": "RunResultError", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.965869Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "", "name": "Formatting", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.970239Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.975284Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.58841, "process_in_blocks": "32", "process_kernel_time": 1.430624, "process_mem_max_rss": "127636", "process_out_blocks": "8", "process_user_time": 8.091081}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 17.58841, \"process_in_blocks\": \"32\", \"process_kernel_time\": 1.430624, \"process_mem_max_rss\": \"127636\", \"process_out_blocks\": \"8\", \"process_user_time\": 8.091081}", "name": "ResourceReport", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.981838Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T12:55:04.987408Z", "elapsed": 17.59491, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Command `dbt run` failed at 12:55:04.987408 after 17.59 seconds", "name": "CommandCompleted", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.987810Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "92bad0f9-5b6e-4c87-900a-3c91f6941b55", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1779, "thread": "MainThread", "ts": "2025-04-25T12:55:04.992473Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:26.888334Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:26.899551Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:28.007987Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:28.455869Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:39.201869Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:39.206649Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.083859Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.100118Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.155622Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "", "name": "Formatting", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.163Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.167948Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "", "name": "Formatting", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.172167Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:41.176351Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.181852Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.302668Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.307425Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.312095Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.315733Z"}}
{"data": {"elapsed": 0.15053256, "query_id": "20250425_041829_00016_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: SUCCESS in 0.151 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.462579Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 2081, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:07:41.472244Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:41.502024Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:41.507529Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:41.596834Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:41.595923Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:41.601848Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:41.605500Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:41.610995Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:41.618253Z"}}
{"data": {"elapsed": 0.67646503, "query_id": "20250425_041829_00018_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: SUCCESS in 0.676 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:42.294755Z"}}
{"data": {"elapsed": 0.68827397, "query_id": "20250425_041829_00017_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: SUCCESS in 0.688 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:42.299119Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:42.306270Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2081, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:07:42.318122Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:42.312187Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 2081, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:07:42.332468Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:07:42.340020Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.352194Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.359350Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.365418Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.369908Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.416427Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.804088Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:42.825008Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:43.223119Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:43.377668Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario (Trino syntax requires no parentheses around the SELECT):\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario (Trino syntax requires no parentheses around the SELECT):\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "name": "SQLQuery", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:43.385988Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:07:43.397784Z"}}
{"data": {"elapsed": 399.23688, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_041831_00019_rjdrs", "status": "CREATE TABLE (1_498_233 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: CREATE TABLE (1_498_233 rows) in 399.237 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:57.548418Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:57.575637Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:57.580551Z"}}
{"data": {"elapsed": 0.5184257, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_042510_00020_rjdrs", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.518 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.118711Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.137287Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "name": "SQLQuery", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.144746Z"}}
{"data": {"elapsed": 0.697685, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_042511_00021_rjdrs", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.698 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.848277Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "JinjaLogDebug", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.885048Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.911510Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:13:56.918290Z"}}
{"data": {"elapsed": 4.362151, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_042512_00022_rjdrs", "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: DROP TABLE in 4.362 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.285848Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.304150Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.311422Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "name": "SQLQuery", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.316117Z"}}
{"data": {"elapsed": 0.047466636, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_042516_00023_rjdrs", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "SQL status: DROP VIEW in 0.047 seconds", "name": "SQLQueryStatus", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.368065Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.422488Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.426666Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": 379.06735, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T13:14:01.432006", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "CREATE TABLE (1_498_233 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[32mCREATE TABLE (1_498_233 rows)\u001b[0m in 379.07s]", "name": "LogModelResult", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.437577Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T13:14:01.432006", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:07:42.351754", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1_498_233 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario (Trino syntax requires no parentheses around the SELECT):\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_041831_00019_rjdrs", "rows_affected": 1498233.0}, "execution_time": 379.06735, "message": "CREATE TABLE (1_498_233 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T13:07:42.824498Z", "name": "compile", "started_at": "2025-04-25T13:07:42.374602Z"}, {"completed_at": "2025-04-25T13:14:01.422076Z", "name": "execute", "started_at": "2025-04-25T13:07:42.829878Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 2081, "thread": "Thread-1", "ts": "2025-04-25T13:14:01.443555Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.453276Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.458232Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.462118Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.466266Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "", "name": "Formatting", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.470190Z"}}
{"data": {"execution": " in 0 hours 6 minutes and 20.29 seconds", "execution_time": 380.29434, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 6 minutes and 20.29 seconds (380.29s).", "name": "FinishedRunningStats", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.474677Z"}}
{"data": {"elapsed_time": 380.29434, "generated_at": "2025-04-25T13:14:01Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (1_498_233 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario (Trino syntax requires no parentheses around the SELECT):\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_041831_00019_rjdrs", "rows_affected": 1498233.0}, "execution_time": 379.06735, "message": "CREATE TABLE (1_498_233 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T13:07:42.824498Z", "name": "compile", "started_at": "2025-04-25T13:07:42.374602Z"}, {"completed_at": "2025-04-25T13:14:01.422076Z", "name": "execute", "started_at": "2025-04-25T13:07:42.829878Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.481809Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.734478Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.750596Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.781969Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "", "name": "Formatting", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.785741Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.790530Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "", "name": "Formatting", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.794533Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.798584Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 422.175, "process_in_blocks": "0", "process_kernel_time": 1.396644, "process_mem_max_rss": "127368", "process_out_blocks": "8", "process_user_time": 10.707607}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 422.175, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.396644, \"process_mem_max_rss\": \"127368\", \"process_out_blocks\": \"8\", \"process_user_time\": 10.707607}", "name": "ResourceReport", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.803893Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T13:14:01.807706Z", "elapsed": 422.17944, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Command `dbt run` succeeded at 13:14:01.807706 after 422.18 seconds", "name": "CommandCompleted", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.808124Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "3b07fde5-93d1-47cf-9459-c5046aef5a86", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 2081, "thread": "MainThread", "ts": "2025-04-25T13:14:01.812127Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:14:58.154999Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:14:58.166444Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:14:59.183401Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:14:59.606426Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:10.478871Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:10.483735Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.898300Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.915924Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.971819Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "", "name": "Formatting", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.980357Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.985205Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "", "name": "Formatting", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.988995Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:12.994654Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.000867Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.127969Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.132574Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.136693Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.140855Z"}}
{"data": {"elapsed": 0.35568008, "query_id": "20250425_042632_00024_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: SUCCESS in 0.356 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.492533Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 2254, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:15:13.502492Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:13.547809Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:13.551121Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:13.687776Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:13.696822Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:13.692329Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:13.703436Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:13.708038Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:13.719635Z"}}
{"data": {"elapsed": 1.1539773, "query_id": "20250425_042632_00026_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: SUCCESS in 1.154 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:14.873421Z"}}
{"data": {"elapsed": 1.1800021, "query_id": "20250425_042632_00025_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: SUCCESS in 1.180 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:14.883588Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:14.891632Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2254, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:15:14.904356Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:14.900445Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 2254, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:15:14.918579Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:15:14.923719Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:14.937236Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:14.942721Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:14.951470Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:14.957010Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:15.034740Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:15.417024Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:15.435717Z"}}
{"data": {"msg": "Invalid value for on_schema_change (append) specified. Setting default value of ignore.", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Invalid value for on_schema_change (append) specified. Setting default value of ignore.", "name": "JinjaLogDebug", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:15.741107Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:15.910154Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:16.037145Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "name": "SQLQuery", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:16.042478Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:15:16.052715Z"}}
{"data": {"elapsed": 312.18655, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_042635_00027_rjdrs", "status": "CREATE TABLE (1_498_233 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: CREATE TABLE (1_498_233 rows) in 312.187 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:07.938514Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:07.982577Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:07.988336Z"}}
{"data": {"elapsed": 0.51139706, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_043147_00028_rjdrs", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.511 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:08.504202Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:08.523042Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "name": "SQLQuery", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:08.528262Z"}}
{"data": {"elapsed": 0.6605256, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_043147_00029_rjdrs", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.661 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:09.194982Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "JinjaLogDebug", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:09.226560Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:09.239030Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:09.244726Z"}}
{"data": {"elapsed": 2.8449032, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_043148_00030_rjdrs", "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: DROP TABLE in 2.845 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.095057Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.117752Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.124562Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "name": "SQLQuery", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.130105Z"}}
{"data": {"elapsed": 0.05345608, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_043151_00031_rjdrs", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "SQL status: DROP VIEW in 0.053 seconds", "name": "SQLQueryStatus", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.188640Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.251059Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.255986Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": 297.3117, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T13:20:12.261639", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "CREATE TABLE (1_498_233 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[32mCREATE TABLE (1_498_233 rows)\u001b[0m in 297.31s]", "name": "LogModelResult", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.266182Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T13:20:12.261639", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:15:14.936761", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1_498_233 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_042635_00027_rjdrs", "rows_affected": 1498233.0}, "execution_time": 297.3117, "message": "CREATE TABLE (1_498_233 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T13:15:15.435241Z", "name": "compile", "started_at": "2025-04-25T13:15:14.963885Z"}, {"completed_at": "2025-04-25T13:20:12.250425Z", "name": "execute", "started_at": "2025-04-25T13:15:15.442009Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 2254, "thread": "Thread-1", "ts": "2025-04-25T13:20:12.273251Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.286230Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.291327Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.296159Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.301182Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "", "name": "Formatting", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.306281Z"}}
{"data": {"execution": " in 0 hours 4 minutes and 59.31 seconds", "execution_time": 299.3122, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 4 minutes and 59.31 seconds (299.31s).", "name": "FinishedRunningStats", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.311899Z"}}
{"data": {"elapsed_time": 299.3122, "generated_at": "2025-04-25T13:20:12Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (1_498_233 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n-- Full-load scenario\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_042635_00027_rjdrs", "rows_affected": 1498233.0}, "execution_time": 297.3117, "message": "CREATE TABLE (1_498_233 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T13:15:15.435241Z", "name": "compile", "started_at": "2025-04-25T13:15:14.963885Z"}, {"completed_at": "2025-04-25T13:20:12.250425Z", "name": "execute", "started_at": "2025-04-25T13:15:15.442009Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.318190Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.601245Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.622423Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.659276Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "", "name": "Formatting", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.665007Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.670010Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "", "name": "Formatting", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.675680Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.681671Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 335.03064, "process_in_blocks": "32", "process_kernel_time": 1.643282, "process_mem_max_rss": "127744", "process_out_blocks": "8", "process_user_time": 10.102455}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 335.03064, \"process_in_blocks\": \"32\", \"process_kernel_time\": 1.643282, \"process_mem_max_rss\": \"127744\", \"process_out_blocks\": \"8\", \"process_user_time\": 10.102455}", "name": "ResourceReport", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.689880Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T13:20:12.695161Z", "elapsed": 335.0369, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Command `dbt run` succeeded at 13:20:12.695161 after 335.04 seconds", "name": "CommandCompleted", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.695760Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "759580d9-ed8e-4f6f-a2b2-17e2fea55db4", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 2254, "thread": "MainThread", "ts": "2025-04-25T13:20:12.700964Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:42.199569Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_team_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'invocation_command': 'dbt run --models scd_team_boxscores --full-refresh --fail-fast --debug --log-format=json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:42.210607Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:43.391200Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:43.858278Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:52.326305Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "name": "PartialParsingFile", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:52.334456Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.425024Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.440660Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.489128Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "", "name": "Formatting", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.498420Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.503671Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "", "name": "Formatting", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.507701Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:54.511924Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.518679Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.628760Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.632803Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.636867Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.641036Z"}}
{"data": {"elapsed": 0.13430496, "query_id": "20250425_043446_00032_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: SUCCESS in 0.134 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.771166Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 2428, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T13:22:54.777331Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores)", "name": "ConnectionReused", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:54.799787Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "NewConnection", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:54.802805Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:54.859083Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:54.869717Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:54.873014Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:54.876814Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:54.881044Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:54.885073Z"}}
{"data": {"elapsed": 0.38631427, "query_id": "20250425_043447_00034_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: SUCCESS in 0.386 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:55.271521Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:55.281444Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 2428, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T13:22:55.291566Z"}}
{"data": {"elapsed": 0.4244423, "query_id": "20250425_043447_00033_rjdrs", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: SUCCESS in 0.424 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:55.305577Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:55.313404Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2428, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T13:22:55.318218Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:22:55.329479Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeStart", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.346210Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores  [RUN]", "name": "LogStartLine", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.358170Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.scd_team_boxscores)", "name": "ConnectionReused", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.364707Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeCompiling", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.372976Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.408878Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeExecuting", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.427792Z"}}
{"data": {"msg": "Invalid value for on_schema_change (append) specified. Setting default value of ignore.", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Invalid value for on_schema_change (append) specified. Setting default value of ignore.", "name": "JinjaLogDebug", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.500957Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_team_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "JinjaLogDebug", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.625152Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.840893Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status in a separate boolean column instead of storing the string 'current'.\n\n\n\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here if needed.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ from the previous row => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name = f.team_name\n              AND f.prev_team_abbrev = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active (last game_date = global max)\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n      We store only valid dates in 'final_date'. No more mixing date vs. 'current'.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        -- Keep these always as DATE\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        -- We'll store \"is_current\" as a boolean if it's the last open block\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2'         AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n-- =============================================\n-- FULL REFRESH\n-- dbt will create/replace the table for you.\n-- =============================================\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status in a separate boolean column instead of storing the string 'current'.\n\n\n\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here if needed.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ from the previous row => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name = f.team_name\n              AND f.prev_team_abbrev = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active (last game_date = global max)\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n      We store only valid dates in 'final_date'. No more mixing date vs. 'current'.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        -- Keep these always as DATE\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        -- We'll store \"is_current\" as a boolean if it's the last open block\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2'         AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n-- =============================================\n-- FULL REFRESH\n-- dbt will create/replace the table for you.\n-- =============================================\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )", "name": "SQLQuery", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.845914Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:22:55.852317Z"}}
{"data": {"elapsed": 16.625614, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_043448_00035_rjdrs", "status": "CREATE TABLE (147_103 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: CREATE TABLE (147_103 rows) in 16.626 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:12.478120Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:12.514980Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:12.524213Z"}}
{"data": {"elapsed": 1.1697595, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_043504_00036_rjdrs", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: RENAME TABLE in 1.170 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:13.698870Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:13.717033Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "name": "SQLQuery", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:13.727021Z"}}
{"data": {"elapsed": 0.66268826, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_043506_00037_rjdrs", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.663 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:14.395668Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "name": "JinjaLogDebug", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:14.428979Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:14.440667Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:14.447983Z"}}
{"data": {"elapsed": 2.814679, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_043506_00038_rjdrs", "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: DROP TABLE in 2.815 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.268483Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.290642Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.297589Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"", "name": "SQLQuery", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.301918Z"}}
{"data": {"elapsed": 0.055535242, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_043509_00039_rjdrs", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "SQL status: DROP VIEW in 0.056 seconds", "name": "SQLQueryStatus", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.363333Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: ROLLBACK", "name": "Rollback", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.419449Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: Close", "name": "ConnectionClosed", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.423945Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores", "execution_time": 22.06512, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T13:23:17.428945", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "status": "CREATE TABLE (147_103 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores  [\u001b[32mCREATE TABLE (147_103 rows)\u001b[0m in 22.07s]", "name": "LogModelResult", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.433341Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T13:23:17.428945", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T13:22:55.344148", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (147_103 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status in a separate boolean column instead of storing the string 'current'.\n\n\n\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here if needed.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ from the previous row => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name = f.team_name\n              AND f.prev_team_abbrev = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active (last game_date = global max)\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n      We store only valid dates in 'final_date'. No more mixing date vs. 'current'.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        -- Keep these always as DATE\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        -- We'll store \"is_current\" as a boolean if it's the last open block\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2'         AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n-- =============================================\n-- FULL REFRESH\n-- dbt will create/replace the table for you.\n-- =============================================\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_043448_00035_rjdrs", "rows_affected": 147103.0}, "execution_time": 22.06512, "message": "CREATE TABLE (147_103 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T13:22:55.427304Z", "name": "compile", "started_at": "2025-04-25T13:22:55.379780Z"}, {"completed_at": "2025-04-25T13:23:17.419038Z", "name": "execute", "started_at": "2025-04-25T13:22:55.432440Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeFinished", "pid": 2428, "thread": "Thread-1", "ts": "2025-04-25T13:23:17.438911Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.448569Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.453475Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_team_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.457683Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.461603Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "", "name": "Formatting", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.465662Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 22.95 seconds", "execution_time": 22.954168, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 22.95 seconds (22.95s).", "name": "FinishedRunningStats", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.470732Z"}}
{"data": {"elapsed_time": 22.954168, "generated_at": "2025-04-25T13:23:17Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (147_103 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status in a separate boolean column instead of storing the string 'current'.\n\n\n\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here if needed.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ from the previous row => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name = f.team_name\n              AND f.prev_team_abbrev = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active (last game_date = global max)\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n      We store only valid dates in 'final_date'. No more mixing date vs. 'current'.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        -- Keep these always as DATE\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        -- We'll store \"is_current\" as a boolean if it's the last open block\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2'         AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n-- =============================================\n-- FULL REFRESH\n-- dbt will create/replace the table for you.\n-- =============================================\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_043448_00035_rjdrs", "rows_affected": 147103.0}, "execution_time": 22.06512, "message": "CREATE TABLE (147_103 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T13:22:55.427304Z", "name": "compile", "started_at": "2025-04-25T13:22:55.379780Z"}, {"completed_at": "2025-04-25T13:23:17.419038Z", "name": "execute", "started_at": "2025-04-25T13:22:55.432440Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.476128Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.770510Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.793275Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.830095Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "", "name": "Formatting", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.834543Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.839740Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "", "name": "Formatting", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.844472Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.850287Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.76861, "process_in_blocks": "0", "process_kernel_time": 1.108967, "process_mem_max_rss": "127176", "process_out_blocks": "8", "process_user_time": 8.466725}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 37.76861, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.108967, \"process_mem_max_rss\": \"127176\", \"process_out_blocks\": \"8\", \"process_user_time\": 8.466725}", "name": "ResourceReport", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.857144Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T13:23:17.862725Z", "elapsed": 37.77524, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Command `dbt run` succeeded at 13:23:17.862725 after 37.78 seconds", "name": "CommandCompleted", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.863412Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "4b2e126f-9166-4b04-916f-c0c732475113", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 2428, "thread": "MainThread", "ts": "2025-04-25T13:23:17.874658Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:43.401709Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'json', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:43.415984Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:44.532906Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:44.982564Z"}}
{"data": {"added": 0, "changed": 2, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.", "name": "PartialParsingEnabled", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:55.734722Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:55.741388Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "name": "PartialParsingFile", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:55.753107Z"}}
{"data": {"exc": "Compilation Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  invalid syntax for function call expression\n    line 7\n      {{ config("}, "info": {"category": "", "code": "Z002", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "error", "msg": "Encountered an error:\nCompilation Error in model scd_player_boxscores (NBA_models/scd_player_boxscores.sql)\n  invalid syntax for function call expression\n    line 7\n      {{ config(", "name": "MainEncounteredError", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:56.877709Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.837201, "process_in_blocks": "32", "process_kernel_time": 1.232865, "process_mem_max_rss": "112308", "process_out_blocks": "8", "process_user_time": 6.031557}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 15.837201, \"process_in_blocks\": \"32\", \"process_kernel_time\": 1.232865, \"process_mem_max_rss\": \"112308\", \"process_out_blocks\": \"8\", \"process_user_time\": 6.031557}", "name": "ResourceReport", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:56.884589Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T14:23:56.888858Z", "elapsed": 15.84248, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "Command `dbt run` failed at 14:23:56.888858 after 15.84 seconds", "name": "CommandCompleted", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:56.889408Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "d5b2b599-31a2-427b-8ab1-db61a35366b6", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 3696, "thread": "MainThread", "ts": "2025-04-25T14:23:56.893938Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:24.913766Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models scd_player_boxscores --full-refresh --fail-fast --debug --log-format=json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:24.926318Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:26.092978Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:26.590259Z"}}
{"data": {"added": 0, "changed": 2, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.", "name": "PartialParsingEnabled", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:38.292333Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "name": "PartialParsingFile", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:38.301124Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_player_boxscores.sql", "name": "PartialParsingFile", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:38.307162Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.033865Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.050833Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.113337Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "", "name": "Formatting", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.123853Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.128735Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "", "name": "Formatting", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.132683Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.138052Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.147537Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.287824Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.294033Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.299380Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.304697Z"}}
{"data": {"elapsed": 0.23069273, "query_id": "20250425_142902_00012_vnxga", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: SUCCESS in 0.231 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.530071Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 3776, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:26:41.544002Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.661259Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.670704Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.912741Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.947070Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.951944Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.943413Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.966919Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.987015Z"}}
{"data": {"elapsed": 1.5165199, "query_id": "20250425_142902_00013_vnxga", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: SUCCESS in 1.517 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.364055Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.375103Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 3776, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:26:41.385712Z"}}
{"data": {"elapsed": 1.833516, "query_id": "20250425_142902_00014_vnxga", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: SUCCESS in 1.834 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.716053Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.738551Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 3776, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:26:41.770922Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:26:41.806031Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeStart", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:41.830984Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [RUN]", "name": "LogStartLine", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:41.855338Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts, now model.nba_team_stats_project.scd_player_boxscores)", "name": "ConnectionReused", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:41.862251Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeCompiling", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:41.868353Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:41.964799Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:42.701478Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeExecuting", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:42.728134Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "JinjaLogDebug", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:43.034015Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:43.172356Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n--------------------------------------------------------------------------------\n-- Full-load scenario\n--------------------------------------------------------------------------------\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n--------------------------------------------------------------------------------\n-- Full-load scenario\n--------------------------------------------------------------------------------\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "name": "SQLQuery", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:43.178734Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:26:43.187500Z"}}
{"data": {"elapsed": 429.33798, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_142906_00015_vnxga", "status": "CREATE TABLE (1_498_233 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: CREATE TABLE (1_498_233 rows) in 429.338 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:22.417398Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:22.453675Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:22.464001Z"}}
{"data": {"elapsed": 0.66998726, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_143615_00016_vnxga", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.670 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.140149Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.161131Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "name": "SQLQuery", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.167905Z"}}
{"data": {"elapsed": 0.64304644, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_143616_00017_vnxga", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.643 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.816915Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "JinjaLogDebug", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.852077Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.864350Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:23.870674Z"}}
{"data": {"elapsed": 3.0648525, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_143616_00018_vnxga", "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: DROP TABLE in 3.065 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:26.940462Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:26.981080Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_player_boxscores\"", "name": "ConnectionUsed", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.002325Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"", "name": "SQLQuery", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.014288Z"}}
{"data": {"elapsed": 0.13418692, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "query_id": "20250425_143620_00019_vnxga", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "SQL status: DROP VIEW in 0.134 seconds", "name": "SQLQueryStatus", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.155805Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.234907Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On model.nba_team_stats_project.scd_player_boxscores: Close", "name": "ConnectionClosed", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.240668Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores", "execution_time": 405.38486, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T14:33:27.245932", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "status": "CREATE TABLE (1_498_233 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.scd_player_boxscores  [\u001b[32mCREATE TABLE (1_498_233 rows)\u001b[0m in 405.38s]", "name": "LogModelResult", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.250617Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T14:33:27.245932", "node_name": "scd_player_boxscores", "node_path": "scd_player_boxscores.sql", "node_relation": {"alias": "scd_player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:26:41.830414", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_player_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (1_498_233 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n--------------------------------------------------------------------------------\n-- Full-load scenario\n--------------------------------------------------------------------------------\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_142906_00015_vnxga", "rows_affected": 1498233.0}, "execution_time": 405.38486, "message": "CREATE TABLE (1_498_233 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T14:26:42.727408Z", "name": "compile", "started_at": "2025-04-25T14:26:41.878538Z"}, {"completed_at": "2025-04-25T14:33:27.234323Z", "name": "execute", "started_at": "2025-04-25T14:26:42.733940Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_player_boxscores", "name": "NodeFinished", "pid": 3776, "thread": "Thread-1", "ts": "2025-04-25T14:33:27.257212Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.268814Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.274995Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.279838Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.284271Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "", "name": "Formatting", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.289065Z"}}
{"data": {"execution": " in 0 hours 6 minutes and 46.15 seconds", "execution_time": 406.15198, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 6 minutes and 46.15 seconds (406.15s).", "name": "FinishedRunningStats", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.296045Z"}}
{"data": {"elapsed_time": 406.15198, "generated_at": "2025-04-25T14:33:27Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (1_498_233 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_player_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_player_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- File: models/scd_player_boxscores.sql\n-- SCD Type 2 logic for player boxscores\n-- Updated to use \"debut_date\" and \"final_date\" columns spanning each continuous stint\n-- that a player is on a single team. If a player later returns to a team after\n-- playing for a different team, it becomes a new stint with new date ranges.\n\n\n\nWITH  __dbt__cte__player_boxscores as (\n-- File: models/player_boxscores.sql\n-- A simple reference to the base Iceberg table loaded by Spark.\n-- We use \"view\" or ephemeral materialization because we only want to reference it.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- Explicit casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n), raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM __dbt__cte__player_boxscores\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if\n          the same (player_id, season, game_id) appears multiple times.\n       - We order by game_date DESC, so the newest record \"wins\".\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\n/* \n   3) Create \"home_team\" / \"away_team\" by parsing the \"matchup\".\n*/\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\n/*\n   4) Compute a hash for change detection.\n*/\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\n/*\n   5) Identify each \"continuous stint\" (block) for a player on a team.\n      - If the current row's team_id != previous row's team_id, we start a new stint.\n      - We do so by using a \"new_team_flag\" and then summing it cumulatively to get a \"team_block\".\n*/\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\n/*\n   6) For each continuous block, we take:\n      - debut_date = MIN(game_date) over that block\n      - final_date = MAX(game_date) over that block\n      This ensures all games in the same stint share the same [debut_date, final_date].\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\n/*\n   7) Build the final dataset: each game row has the entire stint's [debut_date, final_date].\n   - We rename these SCD columns from 'valid_from'/'valid_to' to 'debut_date'/'final_date'.\n   - Optionally keep is_current to show which stints are \"still open\" if desired.\n*/\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            /*\n                Emulate round to 3 decimals:\n                  1) multiply by 1000\n                  2) add 0.5\n                  3) floor\n                  4) divide by 1000.0\n            */\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS field_goal_percentage,\n\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.three_point_field_goal_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS three_point_field_goal_percentage,\n\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE\n              (\n                CAST(\n                  FLOOR((b.free_throw_percentage * 1000.0) + 0.5)\n                  AS DOUBLE\n                )\n                / 1000.0\n              )\n        END AS free_throw_percentage,\n\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n\n        /* \n           We'll keep the same logic for the unique key.\n        */\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n\n        -- SCD columns (renamed):\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n\n--------------------------------------------------------------------------------\n-- Full-load scenario\n--------------------------------------------------------------------------------\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n    field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    free_throw_percentage,\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day,\n    home_team,\n    away_team,\n    row_hash,\n    player_season_game_uk,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_142906_00015_vnxga", "rows_affected": 1498233.0}, "execution_time": 405.38486, "message": "CREATE TABLE (1_498_233 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T14:26:42.727408Z", "name": "compile", "started_at": "2025-04-25T14:26:41.878538Z"}, {"completed_at": "2025-04-25T14:33:27.234323Z", "name": "execute", "started_at": "2025-04-25T14:26:42.733940Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.302960Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.649892Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.671908Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.718001Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "", "name": "Formatting", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.723418Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.730183Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "", "name": "Formatting", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.735995Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.741653Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 455.25186, "process_in_blocks": "8", "process_kernel_time": 1.756863, "process_mem_max_rss": "127684", "process_out_blocks": "8", "process_user_time": 11.306269}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 455.25186, \"process_in_blocks\": \"8\", \"process_kernel_time\": 1.756863, \"process_mem_max_rss\": \"127684\", \"process_out_blocks\": \"8\", \"process_user_time\": 11.306269}", "name": "ResourceReport", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.751917Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T14:33:27.758544Z", "elapsed": 455.2597, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Command `dbt run` succeeded at 14:33:27.758544 after 455.26 seconds", "name": "CommandCompleted", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.760366Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "dda5880d-167a-4451-912c-1fc5ce601a8a", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 3776, "thread": "MainThread", "ts": "2025-04-25T14:33:27.767769Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:51:45.010663Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models scd_team_boxscores --full-refresh --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'static_parser': 'True', 'invocation_command': 'dbt run --models scd_team_boxscores --full-refresh --fail-fast --debug --log-format=json', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:51:45.023457Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:51:44.481836Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:51:45.165237Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:51:58.056015Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/scd_team_boxscores.sql", "name": "PartialParsingFile", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:51:58.063585Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.600680Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.623292Z"}}
{"data": {"stat_line": "25 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "Found 25 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.710136Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "", "name": "Formatting", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.725351Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.734580Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "", "name": "Formatting", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.740718Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:01.752404Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:01.764049Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:01.970642Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:01.982577Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:01.987475Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:01.993950Z"}}
{"data": {"elapsed": 0.5822199, "query_id": "20250425_145621_00020_vnxga", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: SUCCESS in 0.582 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:02.569754Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 4309, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-04-25T14:52:02.579033Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:02.614154Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:02.619706Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:02.742994Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:02.754554Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:02.758739Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:02.767078Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:02.772086Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:02.777409Z"}}
{"data": {"elapsed": 1.2931409, "query_id": "20250425_145622_00022_vnxga", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: SUCCESS in 1.293 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:04.070657Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:04.081720Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 4309, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-04-25T14:52:04.086787Z"}}
{"data": {"elapsed": 1.5181712, "query_id": "20250425_145622_00021_vnxga", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: SUCCESS in 1.518 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:04.290290Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:04.300398Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 4309, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-04-25T14:52:04.307741Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:04.324160Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Began running node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeStart", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.404656Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores  [RUN]", "name": "LogStartLine", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.412835Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts, now model.nba_team_stats_project.scd_team_boxscores)", "name": "ConnectionReused", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.424854Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeCompiling", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.446583Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.571323Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeExecuting", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.608237Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_team_boxscores\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "JinjaLogDebug", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:04.939533Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:05.483421Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status via a boolean column is_current.\n\n\n\n-- -----------------------------------------------------------------------------\n-- Step 1: Build all CTEs to produce final_data\n-- -----------------------------------------------------------------------------\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name    = f.team_name\n             AND f.prev_team_abbrev  = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n-- -----------------------------------------------------------------------------\n-- Step 2: Implement the \u201cincremental\u201d logic with two statements (DELETE + INSERT)\n-- -----------------------------------------------------------------------------\n\n\n-- Full refresh: just SELECT from final_data\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status via a boolean column is_current.\n\n\n\n-- -----------------------------------------------------------------------------\n-- Step 1: Build all CTEs to produce final_data\n-- -----------------------------------------------------------------------------\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name    = f.team_name\n             AND f.prev_team_abbrev  = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n-- -----------------------------------------------------------------------------\n-- Step 2: Implement the \u201cincremental\u201d logic with two statements (DELETE + INSERT)\n-- -----------------------------------------------------------------------------\n\n\n-- Full refresh: just SELECT from final_data\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )", "name": "SQLQuery", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:05.511578Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:05.534616Z"}}
{"data": {"elapsed": 28.748537, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_145625_00023_vnxga", "status": "CREATE TABLE (147_103 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: CREATE TABLE (147_103 rows) in 28.749 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:32.085249Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:32.120282Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:32.128117Z"}}
{"data": {"elapsed": 0.5196911, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_145654_00024_vnxga", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.520 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:32.653463Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:32.680965Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "name": "SQLQuery", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:32.686485Z"}}
{"data": {"elapsed": 0.44825923, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_145654_00025_vnxga", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.448 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:33.139038Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "name": "JinjaLogDebug", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:33.167722Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:33.178108Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_backup\"", "name": "SQLQuery", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:33.183102Z"}}
{"data": {"elapsed": 3.111156, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_145655_00026_vnxga", "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: DROP TABLE in 3.111 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.300199Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.333055Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.scd_team_boxscores\"", "name": "ConnectionUsed", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.341158Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"", "name": "SQLQuery", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.345989Z"}}
{"data": {"elapsed": 0.07148369, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "query_id": "20250425_145658_00027_vnxga", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "SQL status: DROP VIEW in 0.071 seconds", "name": "SQLQueryStatus", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.424955Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: ROLLBACK", "name": "Rollback", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.566770Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On model.nba_team_stats_project.scd_team_boxscores: Close", "name": "ConnectionClosed", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.573173Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores", "execution_time": 32.15763, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T14:52:36.581540", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "status": "CREATE TABLE (147_103 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.scd_team_boxscores  [\u001b[32mCREATE TABLE (147_103 rows)\u001b[0m in 32.16s]", "name": "LogModelResult", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.587928Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-04-25T14:52:36.581540", "node_name": "scd_team_boxscores", "node_path": "scd_team_boxscores.sql", "node_relation": {"alias": "scd_team_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-04-25T14:52:04.403993", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.scd_team_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (147_103 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status via a boolean column is_current.\n\n\n\n-- -----------------------------------------------------------------------------\n-- Step 1: Build all CTEs to produce final_data\n-- -----------------------------------------------------------------------------\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name    = f.team_name\n             AND f.prev_team_abbrev  = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n-- -----------------------------------------------------------------------------\n-- Step 2: Implement the \u201cincremental\u201d logic with two statements (DELETE + INSERT)\n-- -----------------------------------------------------------------------------\n\n\n-- Full refresh: just SELECT from final_data\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_145625_00023_vnxga", "rows_affected": 147103.0}, "execution_time": 32.15763, "message": "CREATE TABLE (147_103 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T14:52:04.607590Z", "name": "compile", "started_at": "2025-04-25T14:52:04.479259Z"}, {"completed_at": "2025-04-25T14:52:36.565902Z", "name": "execute", "started_at": "2025-04-25T14:52:04.613903Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.scd_team_boxscores", "name": "NodeFinished", "pid": 4309, "thread": "Thread-1", "ts": "2025-04-25T14:52:36.601864Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.617066Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.623954Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.scd_team_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.scd_team_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.631285Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.638162Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "", "name": "Formatting", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.644186Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 34.89 seconds", "execution_time": 34.89208, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 34.89 seconds (34.89s).", "name": "FinishedRunningStats", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.651560Z"}}
{"data": {"elapsed_time": 34.89208, "generated_at": "2025-04-25T14:52:36Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (147_103 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.scd_team_boxscores\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"scd_team_boxscores__dbt_tmp\"\n      \n      \n    as (\n      -- models/scd_team_boxscores.sql\n-- SCD Type 2 logic for team boxscores\n-- Detects a new \"block\" or stint whenever (team_id, team_name, team_abbreviation) changes\n-- from one row to the next for the same team_id (ordered chronologically).\n-- Then all games in that block share a single [debut_date, final_date].\n-- We track \"current\" status via a boolean column is_current.\n\n\n\n-- -----------------------------------------------------------------------------\n-- Step 1: Build all CTEs to produce final_data\n-- -----------------------------------------------------------------------------\nWITH base AS (\n    /*\n      1) Pull raw columns from the 'team_boxscores' table.\n         If you have duplicates for (team_id, game_id), deduplicate here.\n         We assume no duplicates for this example.\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        t.season,\n        t.season_type,\n        t.game_id,\n        t.game_date,\n        t.matchup,\n        t.win_loss,\n\n        t.team_points,\n        t.team_fga,\n        t.team_fgm,\n        t.team_fg3a,\n        t.team_fg3m,\n        t.team_fta,\n        t.team_ftm,\n        t.team_tov,\n        t.team_oreb,\n        t.team_dreb,\n        t.team_reb,\n        t.team_ast,\n        t.team_stl,\n        t.team_blk,\n        t.partial_possessions,\n\n        t.team_fg_pct,\n        t.team_fg3_pct,\n        t.team_ft_pct,\n\n        -- home/away references\n        t.home_team_abbreviation AS home_team,\n        t.away_team_abbreviation AS away_team\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n/*\n   2) Compute row_hash so we can keep using it in final_data\n*/\nhash_calc AS (\n    SELECT\n        base.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_'), '-',\n                COALESCE(CAST(base.season AS VARCHAR), '_null_'), '-',\n                COALESCE(base.season_type, '_null_'), '-',\n                COALESCE(CAST(base.game_id AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.game_date AS VARCHAR), '_null_'), '-',\n                COALESCE(base.matchup, '_null_'), '-',\n                COALESCE(base.win_loss, '_null_'), '-',\n                COALESCE(CAST(base.team_points AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fga AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fgm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3a AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3m AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fta AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ftm AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_tov AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_oreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_dreb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_reb AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ast AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_stl AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_blk AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.partial_possessions AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_fg3_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(CAST(base.team_ft_pct AS VARCHAR), '_null_'), '-',\n                COALESCE(base.home_team, '_null_'), '-',\n                COALESCE(base.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\n/*\n   3) Sort each team's games by game_date, detect changes in dimension attributes\n      (if (team_name, team_abbreviation) differ => new block).\n*/\nflag_new_block AS (\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name    = f.team_name\n             AND f.prev_team_abbrev  = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\n/*\n   4) For each team_id, do a cumulative sum of new_block_flag => block_id\n*/\nblocks AS (\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\n/*\n   5) For each block_id, find earliest + latest game_date => block_debut_date, block_final_date\n*/\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\n/*\n   6) Identify the start of the next block\n*/\nwith_next_block AS (\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\n/*\n   7) Determine which teams are still active\n*/\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd FROM base\n),\nteam_activity AS (\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date)\n            THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\n/*\n   8) Final step: for each row, figure out debut_date, final_date, is_current.\n*/\nfinal_data AS (\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n        w.season,\n        w.season_type,\n        w.game_id,\n        w.game_date,\n        w.matchup,\n        w.win_loss,\n        w.team_points,\n        w.team_fga,\n        w.team_fgm,\n        w.team_fg3a,\n        w.team_fg3m,\n        w.team_fta,\n        w.team_ftm,\n        w.team_tov,\n        w.team_oreb,\n        w.team_dreb,\n        w.team_reb,\n        w.team_ast,\n        w.team_stl,\n        w.team_blk,\n        w.partial_possessions,\n        w.team_fg_pct,\n        w.team_fg3_pct,\n        w.team_ft_pct,\n        w.home_team,\n        w.away_team,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Merge key - must be unique\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR), '_',\n            CAST(w.game_id AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n-- -----------------------------------------------------------------------------\n-- Step 2: Implement the \u201cincremental\u201d logic with two statements (DELETE + INSERT)\n-- -----------------------------------------------------------------------------\n\n\n-- Full refresh: just SELECT from final_data\nSELECT\n    team_id,\n    team_name,\n    team_abbreviation,\n    season,\n    season_type,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    team_points,\n    team_fga,\n    team_fgm,\n    team_fg3a,\n    team_fg3m,\n    team_fta,\n    team_ftm,\n    team_tov,\n    team_oreb,\n    team_dreb,\n    team_reb,\n    team_ast,\n    team_stl,\n    team_blk,\n    partial_possessions,\n    team_fg_pct,\n    team_fg3_pct,\n    team_ft_pct,\n    home_team,\n    away_team,\n    debut_date,\n    final_date,\n    is_current,\n    row_hash,\n    team_scd_uk,\n    CURRENT_TIMESTAMP    AS record_created_timestamp,\n    CURRENT_TIMESTAMP    AS record_updated_timestamp,\n    'dbt_scd2'           AS record_updated_by\nFROM final_data\n\n\n    )", "query_id": "20250425_145625_00023_vnxga", "rows_affected": 147103.0}, "execution_time": 32.15763, "message": "CREATE TABLE (147_103 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-04-25T14:52:04.607590Z", "name": "compile", "started_at": "2025-04-25T14:52:04.479259Z"}, {"completed_at": "2025-04-25T14:52:36.565902Z", "name": "execute", "started_at": "2025-04-25T14:52:04.613903Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:36.659004Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.031049Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.053216Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.274998Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "", "name": "Formatting", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.298783Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.329817Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "", "name": "Formatting", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.352963Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.359657Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 56.968876, "process_in_blocks": "8", "process_kernel_time": 1.675476, "process_mem_max_rss": "127552", "process_out_blocks": "8", "process_user_time": 11.120742}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 56.968876, \"process_in_blocks\": \"8\", \"process_kernel_time\": 1.675476, \"process_mem_max_rss\": \"127552\", \"process_out_blocks\": \"8\", \"process_user_time\": 11.120742}", "name": "ResourceReport", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.377648Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-04-25T14:52:37.388293Z", "elapsed": 56.980785, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Command `dbt run` succeeded at 14:52:37.388293 after 56.98 seconds", "name": "CommandCompleted", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.389259Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "9edd6867-f7cc-4f8c-8d9b-58ac7817e463", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 4309, "thread": "MainThread", "ts": "2025-04-25T14:52:37.407357Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "844ea69f-7749-46ab-b5f7-e994d378a242", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2025-05-05T23:19:10.895974Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "844ea69f-7749-46ab-b5f7-e994d378a242", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2025-05-05T23:19:10.917059Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:29.779649Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt deps", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:29.793066Z"}}
{"data": {"path": "/tmp/dbt-downloads-twoe9sxt"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-twoe9sxt'", "name": "DepsSetDownloadDirectory", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.193079Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.197741Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.620122Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.625481Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.713668Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json", "name": "RegistryProgressGETRequest", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.743633Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200", "name": "RegistryProgressGETResponse", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.871877Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json", "name": "RegistryProgressGETRequest", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.887313Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200", "name": "RegistryProgressGETResponse", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:30.996746Z"}}
{"data": {"lock_filepath": "/dbt/package-lock.yml"}, "info": {"category": "", "code": "M031", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Updating lock file in file path: /dbt/package-lock.yml", "name": "DepsLockUpdating", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:31.053366Z"}}
{"data": {"path": "/tmp/dbt-downloads-neoeh4b2"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-neoeh4b2'", "name": "DepsSetDownloadDirectory", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:33.231264Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:33.269992Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:46.602849Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:46.607283Z"}}
{"data": {"package_name": "metaplane/dbt_expectations"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Installing metaplane/dbt_expectations", "name": "DepsStartPackageInstall", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:46.612015Z"}}
{"data": {"version_name": "version 0.10.8"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Installed from version 0.10.8", "name": "DepsInstallInfo", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:55.295245Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:55.300026Z"}}
{"data": {"package_name": "godatadriven/dbt_date"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Installing godatadriven/dbt_date", "name": "DepsStartPackageInstall", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:55.306090Z"}}
{"data": {"version_name": "version 0.10.1"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Installed from version 0.10.1", "name": "DepsInstallInfo", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.595152Z"}}
{"data": {"version_latest": "0.12.0"}, "info": {"category": "", "code": "M016", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Updated version available: 0.12.0", "name": "DepsUpdateAvailable", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.599287Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "", "name": "Formatting", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.603288Z"}}
{"data": {"packages": ["godatadriven/dbt_date"]}, "info": {"category": "", "code": "M019", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "info", "msg": "Updates available for packages: ['godatadriven/dbt_date']                 \nUpdate your versions in packages.yml, then run dbt deps", "name": "DepsNotifyUpdatesAvailable", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.607669Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 30.106604, "process_in_blocks": "456", "process_kernel_time": 2.785561, "process_mem_max_rss": "101232", "process_out_blocks": "7568", "process_user_time": 4.963363}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 30.106604, \"process_in_blocks\": \"456\", \"process_kernel_time\": 2.785561, \"process_mem_max_rss\": \"101232\", \"process_out_blocks\": \"7568\", \"process_user_time\": 4.963363}", "name": "ResourceReport", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.619579Z"}}
{"data": {"command": "dbt deps", "completed_at": "2025-05-06T00:11:59.625693Z", "elapsed": 30.113506, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Command `dbt deps` succeeded at 00:11:59.625693 after 30.11 seconds", "name": "CommandCompleted", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.626519Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "adfb6bef-b011-4d2c-9340-cb60e9ffef88", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1070, "thread": "MainThread", "ts": "2025-05-06T00:11:59.632580Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:31.662267Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt deps", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'json', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:31.674203Z"}}
{"data": {"path": "/tmp/dbt-downloads-urnepqx9"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-urnepqx9'", "name": "DepsSetDownloadDirectory", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.040700Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.045442Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.321903Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.326364Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.406221Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json", "name": "RegistryProgressGETRequest", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.427480Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200", "name": "RegistryProgressGETResponse", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.533926Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json", "name": "RegistryProgressGETRequest", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.547043Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200", "name": "RegistryProgressGETResponse", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.659438Z"}}
{"data": {"lock_filepath": "/dbt/package-lock.yml"}, "info": {"category": "", "code": "M031", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Updating lock file in file path: /dbt/package-lock.yml", "name": "DepsLockUpdating", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.722350Z"}}
{"data": {"path": "/tmp/dbt-downloads-cn1o5dlu"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-cn1o5dlu'", "name": "DepsSetDownloadDirectory", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.743045Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:32.787153Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:47.448705Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:47.453654Z"}}
{"data": {"package_name": "metaplane/dbt_expectations"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Installing metaplane/dbt_expectations", "name": "DepsStartPackageInstall", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:47.458157Z"}}
{"data": {"version_name": "version 0.10.8"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Installed from version 0.10.8", "name": "DepsInstallInfo", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:57.448395Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:57.452732Z"}}
{"data": {"package_name": "godatadriven/dbt_date"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Installing godatadriven/dbt_date", "name": "DepsStartPackageInstall", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:12:57.456255Z"}}
{"data": {"version_name": "version 0.10.1"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Installed from version 0.10.1", "name": "DepsInstallInfo", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.493451Z"}}
{"data": {"version_latest": "0.12.0"}, "info": {"category": "", "code": "M016", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Updated version available: 0.12.0", "name": "DepsUpdateAvailable", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.496731Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "", "name": "Formatting", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.501359Z"}}
{"data": {"packages": ["godatadriven/dbt_date"]}, "info": {"category": "", "code": "M019", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "info", "msg": "Updates available for packages: ['godatadriven/dbt_date']                 \nUpdate your versions in packages.yml, then run dbt deps", "name": "DepsNotifyUpdatesAvailable", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.504974Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 30.112778, "process_in_blocks": "0", "process_kernel_time": 2.53045, "process_mem_max_rss": "101204", "process_out_blocks": "7568", "process_user_time": 4.871616}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 30.112778, \"process_in_blocks\": \"0\", \"process_kernel_time\": 2.53045, \"process_mem_max_rss\": \"101204\", \"process_out_blocks\": \"7568\", \"process_user_time\": 4.871616}", "name": "ResourceReport", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.512797Z"}}
{"data": {"command": "dbt deps", "completed_at": "2025-05-06T00:13:01.518200Z", "elapsed": 30.118917, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Command `dbt deps` succeeded at 00:13:01.518200 after 30.12 seconds", "name": "CommandCompleted", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.518790Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "71598d8d-86e7-4cf8-ba3f-e0a185c28f02", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1093, "thread": "MainThread", "ts": "2025-05-06T00:13:01.523055Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:32.688115Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:32.700178Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:33.688375Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:34.105883Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:34.143913Z"}}
{"data": {"file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "patch_name": "scd_opponent_team_boxscores", "yaml_key": "models"}, "info": {"category": "", "code": "I058", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Did not find matching node for patch with name 'scd_opponent_team_boxscores' in the 'models' section of file 'NBA_tests/scd_opponent_boxscores_tests.yml'", "name": "NoNodeForYamlKey", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.129965Z"}}
{"data": {"disabled": "False", "original_file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "resource_type_title": "Test", "target_kind": "node", "target_name": "scd_opponent_team_boxscores", "target_package": "", "unique_id": "test.nba_team_stats_project.dbt_utils_not_null_scd_opponent_team_boxscores_row_hash.7341a07387"}, "info": {"category": "", "code": "I060", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Test 'test.nba_team_stats_project.dbt_utils_not_null_scd_opponent_team_boxscores_row_hash.7341a07387' (NBA_tests/scd_opponent_boxscores_tests.yml) depends on a node named 'scd_opponent_team_boxscores' in package '' which was not found", "name": "NodeNotFoundOrDisabled", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.585899Z"}}
{"data": {"disabled": "False", "original_file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "resource_type_title": "Test", "target_kind": "node", "target_name": "scd_opponent_team_boxscores", "target_package": "", "unique_id": "test.nba_team_stats_project.dbt_utils_unique_scd_opponent_team_boxscores_opponent_scd_uk.bca5d2835d"}, "info": {"category": "", "code": "I060", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Test 'test.nba_team_stats_project.dbt_utils_unique_scd_opponent_team_boxscores_opponent_scd_uk.bca5d2835d' (NBA_tests/scd_opponent_boxscores_tests.yml) depends on a node named 'scd_opponent_team_boxscores' in package '' which was not found", "name": "NodeNotFoundOrDisabled", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.592041Z"}}
{"data": {"disabled": "False", "original_file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "resource_type_title": "Test", "target_kind": "node", "target_name": "scd_opponent_team_boxscores", "target_package": "", "unique_id": "test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_points__300__0.5382c8617c"}, "info": {"category": "", "code": "I060", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Test 'test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_points__300__0.5382c8617c' (NBA_tests/scd_opponent_boxscores_tests.yml) depends on a node named 'scd_opponent_team_boxscores' in package '' which was not found", "name": "NodeNotFoundOrDisabled", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.596770Z"}}
{"data": {"disabled": "False", "original_file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "resource_type_title": "Test", "target_kind": "node", "target_name": "scd_opponent_team_boxscores", "target_package": "", "unique_id": "test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_oreb__100__0.590fac63b2"}, "info": {"category": "", "code": "I060", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Test 'test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_oreb__100__0.590fac63b2' (NBA_tests/scd_opponent_boxscores_tests.yml) depends on a node named 'scd_opponent_team_boxscores' in package '' which was not found", "name": "NodeNotFoundOrDisabled", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.604993Z"}}
{"data": {"disabled": "False", "original_file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "resource_type_title": "Test", "target_kind": "node", "target_name": "scd_opponent_team_boxscores", "target_package": "", "unique_id": "test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_dreb__100__0.e1060a7d67"}, "info": {"category": "", "code": "I060", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Test 'test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_dreb__100__0.e1060a7d67' (NBA_tests/scd_opponent_boxscores_tests.yml) depends on a node named 'scd_opponent_team_boxscores' in package '' which was not found", "name": "NodeNotFoundOrDisabled", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.611028Z"}}
{"data": {"disabled": "False", "original_file_path": "NBA_tests/scd_opponent_boxscores_tests.yml", "resource_type_title": "Test", "target_kind": "node", "target_name": "scd_opponent_team_boxscores", "target_package": "", "unique_id": "test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_ast__100__0.91af2ea86a"}, "info": {"category": "", "code": "I060", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Test 'test.nba_team_stats_project.dbt_utils_check_numeric_range_scd_opponent_team_boxscores_opp_ast__100__0.91af2ea86a' (NBA_tests/scd_opponent_boxscores_tests.yml) depends on a node named 'scd_opponent_team_boxscores' in package '' which was not found", "name": "NodeNotFoundOrDisabled", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.616083Z"}}
{"data": {"exc": "[Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'"}, "info": {"category": "", "code": "Z002", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "error", "msg": "Encountered an error:\n[Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'", "name": "MainEncounteredError", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.969230Z"}}
{"data": {"stack_trace": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 153, in wrapper\n    result, success = func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 103, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 235, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 264, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 327, in wrapper\n    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 351, in setup_manifest\n    ctx.obj[\"manifest\"] = parse_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 2069, in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 312, in get_full_manifest\n    manifest = loader.load()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 510, in load\n    self.write_manifest_for_partial_parse()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 820, in write_manifest_for_partial_parse\n    with open(path, \"wb\") as fp:\nFileNotFoundError: [Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'\n"}, "info": {"category": "", "code": "Z003", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "error", "msg": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 153, in wrapper\n    result, success = func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 103, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 235, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 264, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 327, in wrapper\n    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 351, in setup_manifest\n    ctx.obj[\"manifest\"] = parse_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 2069, in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 312, in get_full_manifest\n    manifest = loader.load()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 510, in load\n    self.write_manifest_for_partial_parse()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 820, in write_manifest_for_partial_parse\n    with open(path, \"wb\") as fp:\nFileNotFoundError: [Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'\n", "name": "MainStackTrace", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.974840Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.470478, "process_in_blocks": "256", "process_kernel_time": 1.30021, "process_mem_max_rss": "116584", "process_out_blocks": "24", "process_user_time": 12.871075}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 19.470478, \"process_in_blocks\": \"256\", \"process_kernel_time\": 1.30021, \"process_mem_max_rss\": \"116584\", \"process_out_blocks\": \"24\", \"process_user_time\": 12.871075}", "name": "ResourceReport", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.982211Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T00:14:51.989332Z", "elapsed": 19.47863, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "debug", "msg": "Command `dbt run` failed at 00:14:51.989332 after 19.48 seconds", "name": "CommandCompleted", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.990494Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "42b324fe-1e9d-4a7f-9530-2c396dab0851", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1138, "thread": "MainThread", "ts": "2025-05-06T00:14:51.996687Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:03.528781Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'debug': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'static_parser': 'True', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:03.543030Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:04.656556Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:05.197010Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:05.235326Z"}}
{"data": {"exc": "[Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'"}, "info": {"category": "", "code": "Z002", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "error", "msg": "Encountered an error:\n[Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'", "name": "MainEncounteredError", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:25.185666Z"}}
{"data": {"stack_trace": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 153, in wrapper\n    result, success = func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 103, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 235, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 264, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 327, in wrapper\n    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 351, in setup_manifest\n    ctx.obj[\"manifest\"] = parse_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 2069, in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 312, in get_full_manifest\n    manifest = loader.load()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 510, in load\n    self.write_manifest_for_partial_parse()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 820, in write_manifest_for_partial_parse\n    with open(path, \"wb\") as fp:\nFileNotFoundError: [Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'\n"}, "info": {"category": "", "code": "Z003", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "error", "msg": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 153, in wrapper\n    result, success = func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 103, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 235, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 264, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 327, in wrapper\n    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 351, in setup_manifest\n    ctx.obj[\"manifest\"] = parse_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 2069, in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 312, in get_full_manifest\n    manifest = loader.load()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 510, in load\n    self.write_manifest_for_partial_parse()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 820, in write_manifest_for_partial_parse\n    with open(path, \"wb\") as fp:\nFileNotFoundError: [Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'\n", "name": "MainStackTrace", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:25.202316Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.898087, "process_in_blocks": "0", "process_kernel_time": 1.397509, "process_mem_max_rss": "116548", "process_out_blocks": "8", "process_user_time": 13.755489}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 21.898087, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.397509, \"process_mem_max_rss\": \"116548\", \"process_out_blocks\": \"8\", \"process_user_time\": 13.755489}", "name": "ResourceReport", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:25.222934Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T00:16:25.231359Z", "elapsed": 21.90768, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "debug", "msg": "Command `dbt run` failed at 00:16:25.231359 after 21.91 seconds", "name": "CommandCompleted", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:25.231943Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "09d308f5-e18e-4032-a516-b8ee97833146", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1183, "thread": "MainThread", "ts": "2025-05-06T00:16:25.244943Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:21:42.113205Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:21:42.138025Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:21:43.613427Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:21:44.065745Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:21:44.100093Z"}}
{"data": {"exc": "[Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'"}, "info": {"category": "", "code": "Z002", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "error", "msg": "Encountered an error:\n[Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'", "name": "MainEncounteredError", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:22:02.601076Z"}}
{"data": {"stack_trace": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 153, in wrapper\n    result, success = func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 103, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 235, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 264, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 327, in wrapper\n    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 351, in setup_manifest\n    ctx.obj[\"manifest\"] = parse_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 2069, in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 312, in get_full_manifest\n    manifest = loader.load()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 510, in load\n    self.write_manifest_for_partial_parse()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 820, in write_manifest_for_partial_parse\n    with open(path, \"wb\") as fp:\nFileNotFoundError: [Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'\n"}, "info": {"category": "", "code": "Z003", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "error", "msg": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 153, in wrapper\n    result, success = func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 103, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 235, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 264, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 311, in wrapper\n    return func(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 327, in wrapper\n    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py\", line 351, in setup_manifest\n    ctx.obj[\"manifest\"] = parse_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 2069, in parse_manifest\n    manifest = ManifestLoader.get_full_manifest(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 312, in get_full_manifest\n    manifest = loader.load()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 510, in load\n    self.write_manifest_for_partial_parse()\n  File \"/usr/local/lib/python3.9/site-packages/dbt/parser/manifest.py\", line 820, in write_manifest_for_partial_parse\n    with open(path, \"wb\") as fp:\nFileNotFoundError: [Errno 2] No such file or directory: '/dbt/target/partial_parse.msgpack'\n", "name": "MainStackTrace", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:22:02.606849Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.924707, "process_in_blocks": "48", "process_kernel_time": 1.617653, "process_mem_max_rss": "116024", "process_out_blocks": "8", "process_user_time": 13.893958}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 20.924707, \"process_in_blocks\": \"48\", \"process_kernel_time\": 1.617653, \"process_mem_max_rss\": \"116024\", \"process_out_blocks\": \"8\", \"process_user_time\": 13.893958}", "name": "ResourceReport", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:22:02.616252Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T00:22:02.624901Z", "elapsed": 20.935583, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "debug", "msg": "Command `dbt run` failed at 00:22:02.624901 after 20.94 seconds", "name": "CommandCompleted", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:22:02.625813Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "e40bd7ec-10ea-4dbc-a46e-4742707d8e4f", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1321, "thread": "MainThread", "ts": "2025-05-06T00:22:02.632832Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "793a00ef-f7c9-44b1-8bc7-4369b6b6ac0f", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1429, "thread": "MainThread", "ts": "2025-05-06T00:25:25.664094Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json --no-partial-parse", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "False", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "793a00ef-f7c9-44b1-8bc7-4369b6b6ac0f", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json --no-partial-parse', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1429, "thread": "MainThread", "ts": "2025-05-06T00:25:25.685180Z"}}
{"data": {"exc": "Runtime Error\n  at path []: Additional properties are not allowed ('partial_parse' was unexpected)\n\nError encountered in /dbt/dbt_project.yml"}, "info": {"category": "", "code": "Z002", "extra": {}, "invocation_id": "793a00ef-f7c9-44b1-8bc7-4369b6b6ac0f", "level": "error", "msg": "Encountered an error:\nRuntime Error\n  at path []: Additional properties are not allowed ('partial_parse' was unexpected)\n\nError encountered in /dbt/dbt_project.yml", "name": "MainEncounteredError", "pid": 1429, "thread": "MainThread", "ts": "2025-05-06T00:25:27.134381Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6997776, "process_in_blocks": "0", "process_kernel_time": 0.316335, "process_mem_max_rss": "100824", "process_out_blocks": "8", "process_user_time": 4.319953}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "793a00ef-f7c9-44b1-8bc7-4369b6b6ac0f", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 1.6997776, \"process_in_blocks\": \"0\", \"process_kernel_time\": 0.316335, \"process_mem_max_rss\": \"100824\", \"process_out_blocks\": \"8\", \"process_user_time\": 4.319953}", "name": "ResourceReport", "pid": 1429, "thread": "MainThread", "ts": "2025-05-06T00:25:27.140144Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T00:25:27.144729Z", "elapsed": 1.7051635, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "793a00ef-f7c9-44b1-8bc7-4369b6b6ac0f", "level": "debug", "msg": "Command `dbt run` failed at 00:25:27.144729 after 1.71 seconds", "name": "CommandCompleted", "pid": 1429, "thread": "MainThread", "ts": "2025-05-06T00:25:27.145435Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "793a00ef-f7c9-44b1-8bc7-4369b6b6ac0f", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1429, "thread": "MainThread", "ts": "2025-05-06T00:25:27.153436Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:09.377640Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json --no-partial-parse", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "False", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json --no-partial-parse', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:09.388954Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:10.524325Z"}}
{"data": {"exc": "Compilation Error\n  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run \"dbt deps\" to install package dependencies."}, "info": {"category": "", "code": "Z002", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "error", "msg": "Encountered an error:\nCompilation Error\n  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run \"dbt deps\" to install package dependencies.", "name": "MainEncounteredError", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:10.839477Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6845471, "process_in_blocks": "8", "process_kernel_time": 0.573326, "process_mem_max_rss": "103688", "process_out_blocks": "8", "process_user_time": 4.606379}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 1.6845471, \"process_in_blocks\": \"8\", \"process_kernel_time\": 0.573326, \"process_mem_max_rss\": \"103688\", \"process_out_blocks\": \"8\", \"process_user_time\": 4.606379}", "name": "ResourceReport", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:10.846076Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T00:26:10.851287Z", "elapsed": 1.6908438, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "debug", "msg": "Command `dbt run` failed at 00:26:10.851287 after 1.69 seconds", "name": "CommandCompleted", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:10.852044Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "3c7f46e2-94fa-4ba9-ad1a-00e929740477", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1446, "thread": "MainThread", "ts": "2025-05-06T00:26:10.856953Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e7215e27-deef-49e2-b252-ae2d6a14b23a", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2025-05-06T00:33:38.109384Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e7215e27-deef-49e2-b252-ae2d6a14b23a", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2025-05-06T00:33:38.129440Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:42.308426Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt deps", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:42.318938Z"}}
{"data": {"path": "/tmp/dbt-downloads-042e6ty0"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-042e6ty0'", "name": "DepsSetDownloadDirectory", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:42.707767Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:42.711534Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.168493Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.173614Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.257056Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json", "name": "RegistryProgressGETRequest", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.272035Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200", "name": "RegistryProgressGETResponse", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.388566Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json", "name": "RegistryProgressGETRequest", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.403037Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200", "name": "RegistryProgressGETResponse", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.519631Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:43.530670Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:55.840646Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:55.844364Z"}}
{"data": {"package_name": "metaplane/dbt_expectations"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Installing metaplane/dbt_expectations", "name": "DepsStartPackageInstall", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:34:55.848544Z"}}
{"data": {"version_name": "version 0.10.8"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Installed from version 0.10.8", "name": "DepsInstallInfo", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:04.663295Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:04.667457Z"}}
{"data": {"package_name": "godatadriven/dbt_date"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Installing godatadriven/dbt_date", "name": "DepsStartPackageInstall", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:04.672335Z"}}
{"data": {"version_name": "version 0.10.1"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Installed from version 0.10.1", "name": "DepsInstallInfo", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.151404Z"}}
{"data": {"version_latest": "0.12.0"}, "info": {"category": "", "code": "M016", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Updated version available: 0.12.0", "name": "DepsUpdateAvailable", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.154947Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "", "name": "Formatting", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.158659Z"}}
{"data": {"packages": ["godatadriven/dbt_date"]}, "info": {"category": "", "code": "M019", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "info", "msg": "Updates available for packages: ['godatadriven/dbt_date']                 \nUpdate your versions in packages.yml, then run dbt deps", "name": "DepsNotifyUpdatesAvailable", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.161982Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 33.146362, "process_in_blocks": "472", "process_kernel_time": 2.336149, "process_mem_max_rss": "101300", "process_out_blocks": "7568", "process_user_time": 4.577161}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 33.146362, \"process_in_blocks\": \"472\", \"process_kernel_time\": 2.336149, \"process_mem_max_rss\": \"101300\", \"process_out_blocks\": \"7568\", \"process_user_time\": 4.577161}", "name": "ResourceReport", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.171560Z"}}
{"data": {"command": "dbt deps", "completed_at": "2025-05-06T00:35:15.175710Z", "elapsed": 33.151295, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Command `dbt deps` succeeded at 00:35:15.175710 after 33.15 seconds", "name": "CommandCompleted", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.176169Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "dcecafa2-e02d-4925-8a6d-03d6449e4070", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 56, "thread": "MainThread", "ts": "2025-05-06T00:35:15.180453Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:35:45.245229Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'True', 'fail_fast': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:35:45.258360Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:35:46.513748Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:35:46.999280Z"}}
{"data": {"reason": "saved manifest not found. Starting full parse."}, "info": {"category": "", "code": "I024", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Unable to do partial parsing because saved manifest not found. Starting full parse.", "name": "UnableToPartialParse", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:35:47.034912Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.154748Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.169700Z"}}
{"data": {"stat_line": "12 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Found 12 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.230929Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "", "name": "Formatting", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.239823Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.244138Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "", "name": "Formatting", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.248871Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:03.255242Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:03.262406Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:03.406355Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:03.415421Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:03.419634Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:03.423209Z"}}
{"data": {"elapsed": 11.516022, "query_id": "20250505_215441_00000_qca9w", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "SQL status: SUCCESS in 11.516 seconds", "name": "SQLQueryStatus", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:14.935659Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 79, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:36:14.943621Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:14.965020Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:14.967962Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:15.053832Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:15.053213Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:15.058761Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:15.063850Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:15.068273Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:15.072176Z"}}
{"data": {"elapsed": 4.941074, "query_id": "20250505_215452_00002_qca9w", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "SQL status: SUCCESS in 4.941 seconds", "name": "SQLQueryStatus", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:20.013418Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:20.024926Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 79, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:36:20.034138Z"}}
{"data": {"elapsed": 4.9804435, "query_id": "20250505_215452_00001_qca9w", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "SQL status: SUCCESS in 4.980 seconds", "name": "SQLQueryStatus", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:20.048700Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:20.076751Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 79, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:36:20.094236Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:20.104606Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Began running node model.nba_team_stats_project.player_boxscores", "name": "NodeStart", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.157644Z"}}
{"data": {"description": "sql view model iceberg_nba_player_boxscores.player_boxscores", "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "1 of 1 START sql view model iceberg_nba_player_boxscores.player_boxscores ...... [RUN]", "name": "LogStartLine", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.164254Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.player_boxscores)", "name": "ConnectionReused", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.171985Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.player_boxscores", "name": "NodeCompiling", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.177738Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.196208Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.player_boxscores", "name": "NodeExecuting", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.224643Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.player_boxscores\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.player_boxscores\"", "name": "JinjaLogDebug", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.296307Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.player_boxscores\"", "name": "ConnectionUsed", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.335389Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On model.nba_team_stats_project.player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  ", "name": "SQLQuery", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.339996Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:20.344106Z"}}
{"data": {"elapsed": 7.8564463, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "query_id": "20250505_215457_00003_qca9w", "status": "CREATE VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "SQL status: CREATE VIEW in 7.856 seconds", "name": "SQLQueryStatus", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:28.099930Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On model.nba_team_stats_project.player_boxscores: ROLLBACK", "name": "Rollback", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:28.175489Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On model.nba_team_stats_project.player_boxscores: Close", "name": "ConnectionClosed", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:28.179750Z"}}
{"data": {"description": "sql view model iceberg_nba_player_boxscores.player_boxscores", "execution_time": 8.014212, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2025-05-06T00:36:28.185206", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "status": "CREATE VIEW", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "1 of 1 OK created sql view model iceberg_nba_player_boxscores.player_boxscores . [\u001b[32mCREATE VIEW\u001b[0m in 8.01s]", "name": "LogModelResult", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:28.189752Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2025-05-06T00:36:28.185206", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:36:20.157181", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  ", "query_id": "20250505_215457_00003_qca9w", "rows_affected": -1.0}, "execution_time": 8.014212, "message": "CREATE VIEW", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T00:36:20.224137Z", "name": "compile", "started_at": "2025-05-06T00:36:20.183090Z"}, {"completed_at": "2025-05-06T00:36:28.175105Z", "name": "execute", "started_at": "2025-05-06T00:36:20.228847Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.player_boxscores", "name": "NodeFinished", "pid": 79, "thread": "Thread-1", "ts": "2025-05-06T00:36:28.194385Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.204089Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.209137Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.212836Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.217063Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "", "name": "Formatting", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.222505Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 24.97 seconds", "execution_time": 24.967941, "stat_line": "1 view model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Finished running 1 view model in 0 hours 0 minutes and 24.97 seconds (24.97s).", "name": "FinishedRunningStats", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.227501Z"}}
{"data": {"elapsed_time": 24.967941, "generated_at": "2025-05-06T00:36:28Z", "results": [{"adapter_response": {"_message": "CREATE VIEW", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  ", "query_id": "20250505_215457_00003_qca9w", "rows_affected": -1.0}, "execution_time": 8.014212, "message": "CREATE VIEW", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T00:36:20.224137Z", "name": "compile", "started_at": "2025-05-06T00:36:20.183090Z"}, {"completed_at": "2025-05-06T00:36:28.175105Z", "name": "execute", "started_at": "2025-05-06T00:36:20.228847Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.233745Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.605689Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.620595Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.658358Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "", "name": "Formatting", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.668302Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.674896Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "", "name": "Formatting", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.682103Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.692641Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 43.87176, "process_in_blocks": "304", "process_kernel_time": 1.563866, "process_mem_max_rss": "125380", "process_out_blocks": "96", "process_user_time": 12.431752}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 43.87176, \"process_in_blocks\": \"304\", \"process_kernel_time\": 1.563866, \"process_mem_max_rss\": \"125380\", \"process_out_blocks\": \"96\", \"process_user_time\": 12.431752}", "name": "ResourceReport", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.702102Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T00:36:28.706552Z", "elapsed": 43.876934, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Command `dbt run` succeeded at 00:36:28.706552 after 43.88 seconds", "name": "CommandCompleted", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.707196Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "a5d6b09b-1a4f-445f-9cee-c544d538d5cc", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 79, "thread": "MainThread", "ts": "2025-05-06T00:36:28.714996Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:08.399023Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models dim_players_scd2 --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models dim_players_scd2 --fail-fast --debug --log-format=json', 'introspect': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:08.409776Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:09.320192Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:09.709516Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:19.567314Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:19.574650Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.277926Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.296173Z"}}
{"data": {"stat_line": "12 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "Found 12 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.357455Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "", "name": "Formatting", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.368380Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.373710Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "", "name": "Formatting", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.378577Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:20.385127Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.392006Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.522263Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.528163Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.534745Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.539128Z"}}
{"data": {"elapsed": 0.39439425, "query_id": "20250505_220159_00004_qca9w", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "SQL status: SUCCESS in 0.394 seconds", "name": "SQLQueryStatus", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.929136Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 261, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T00:43:20.938140Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:20.966635Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:20.995274Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:21.072790Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:21.093422Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:21.095170Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:21.101883Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:21.112777Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:21.123924Z"}}
{"data": {"elapsed": 1.144418, "query_id": "20250505_220159_00005_qca9w", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "SQL status: SUCCESS in 1.144 seconds", "name": "SQLQueryStatus", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:22.256853Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:22.265296Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 261, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T00:43:22.270386Z"}}
{"data": {"elapsed": 1.4353963, "query_id": "20250505_220159_00006_qca9w", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "SQL status: SUCCESS in 1.435 seconds", "name": "SQLQueryStatus", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:22.559457Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:22.578726Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 261, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T00:43:22.584320Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 261, "thread": "MainThread", "ts": "2025-05-06T00:43:22.595096Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Began running node model.nba_team_stats_project.dim_players_scd2", "name": "NodeStart", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:22.647798Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd2", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.dim_players_scd2  [RUN]", "name": "LogStartLine", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:22.660875Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.dim_players_scd2)", "name": "ConnectionReused", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:22.666245Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.dim_players_scd2", "name": "NodeCompiling", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:22.688688Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.dim_players_scd2\"", "name": "WritingInjectedSQLForNode", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:22.764104Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.dim_players_scd2", "name": "NodeExecuting", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:22.791011Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd2\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd2\"", "name": "JinjaLogDebug", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:23.015771Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:23.113288Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n      \n      \n    as (\n      -- SCD Type 2 logic for Player Dimension\n\n\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n          Even though we only ultimately keep dimension columns,\n          we \"keep the structure\" and still select everything here.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if (player_id, season, game_id) repeats.\n          Again, we keep the flow, even though dimension-level logic won\u2019t rely on game-level data.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    /*\n       3) We keep this step as-is, though it's more relevant for fact data.\n          (You might remove it entirely for a pure dimension,\n           but here we keep it to honor \"keep all structure and flow the same\".)\n    */\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    /*\n       4) Compute a hash, but ONLY from the dimension attributes \n          we care about for SCD2 (e.g. player_id, player_name, team_id, team_abbreviation, team_name).\n          We remove game-level columns from the concatenation.\n    */\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    /*\n       5) Detect changes in the player's team (if you consider team part of the dimension).\n          We keep the same logic, but it\u2019s effectively how we split SCD blocks by team changes.\n    */\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    /*\n       6) Summation over the partition to identify each contiguous block of team affiliation.\n    */\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    /*\n       7) For each block, identify the earliest date (block_debut_date) and latest date (block_final_date).\n          We keep the \"structure\" even though we\u2019ll store only dimension data in final.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    /*\n       8) Final SELECT for the dimension table. \n          We remove all fact\u2010level columns (game_id, game_date, stats, etc.) \n          and keep only dimension columns plus SCD2 fields.\n    */\n    SELECT\n        -- Surrogate key for the new dimension version:\n        MD5(\n            to_utf8(\n                CONCAT(\n                    COALESCE(CAST(b.player_id AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.team_block AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.block_debut_date AS VARCHAR), '_null_')\n                )\n            )\n        ) AS player_scd_uk,       -- SCD2 Surrogate key (example)\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n\n        -- The row_hash from dimension attributes\n        b.row_hash,\n\n        -- SCD2 Effective date range\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        -- is_current (true if it's the last block for this player)\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        -- Auditing columns\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n-- In a full-refresh run, load everything.\nSELECT * FROM final_data\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n      \n      \n    as (\n      -- SCD Type 2 logic for Player Dimension\n\n\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n          Even though we only ultimately keep dimension columns,\n          we \"keep the structure\" and still select everything here.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if (player_id, season, game_id) repeats.\n          Again, we keep the flow, even though dimension-level logic won\u2019t rely on game-level data.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    /*\n       3) We keep this step as-is, though it's more relevant for fact data.\n          (You might remove it entirely for a pure dimension,\n           but here we keep it to honor \"keep all structure and flow the same\".)\n    */\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    /*\n       4) Compute a hash, but ONLY from the dimension attributes \n          we care about for SCD2 (e.g. player_id, player_name, team_id, team_abbreviation, team_name).\n          We remove game-level columns from the concatenation.\n    */\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    /*\n       5) Detect changes in the player's team (if you consider team part of the dimension).\n          We keep the same logic, but it\u2019s effectively how we split SCD blocks by team changes.\n    */\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    /*\n       6) Summation over the partition to identify each contiguous block of team affiliation.\n    */\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    /*\n       7) For each block, identify the earliest date (block_debut_date) and latest date (block_final_date).\n          We keep the \"structure\" even though we\u2019ll store only dimension data in final.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    /*\n       8) Final SELECT for the dimension table. \n          We remove all fact\u2010level columns (game_id, game_date, stats, etc.) \n          and keep only dimension columns plus SCD2 fields.\n    */\n    SELECT\n        -- Surrogate key for the new dimension version:\n        MD5(\n            to_utf8(\n                CONCAT(\n                    COALESCE(CAST(b.player_id AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.team_block AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.block_debut_date AS VARCHAR), '_null_')\n                )\n            )\n        ) AS player_scd_uk,       -- SCD2 Surrogate key (example)\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n\n        -- The row_hash from dimension attributes\n        b.row_hash,\n\n        -- SCD2 Effective date range\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        -- is_current (true if it's the last block for this player)\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        -- Auditing columns\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n-- In a full-refresh run, load everything.\nSELECT * FROM final_data\n\n    )", "name": "SQLQuery", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:23.125612Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:43:23.140836Z"}}
{"data": {"elapsed": 98.70138, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250505_220201_00007_qca9w", "status": "CREATE TABLE (1_498_773 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "SQL status: CREATE TABLE (1_498_773 rows) in 98.701 seconds", "name": "SQLQueryStatus", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.383371Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.418452Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.431676Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"", "name": "SQLQuery", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.435626Z"}}
{"data": {"elapsed": 0.052459713, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250505_220340_00008_qca9w", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "SQL status: DROP VIEW in 0.052 seconds", "name": "SQLQueryStatus", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.491956Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.504571Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )", "name": "SQLQuery", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:01.511009Z"}}
{"data": {"elapsed": 5.829272, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250505_220340_00009_qca9w", "status": "DELETE (0 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "SQL status: DELETE (0 rows) in 5.829 seconds", "name": "SQLQueryStatus", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:07.346394Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:07.371452Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T00:43:22.647286", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        SELECT\n            player_scd_uk,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            row_hash,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "4acebc07-aa55-4cd1-b2cc-6efcd91d93b7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        SELECT\n            player_scd_uk,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            row_hash,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp", "name": "SQLQuery", "pid": 261, "thread": "Thread-1", "ts": "2025-05-06T00:45:07.381806Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "f20f30ab-fb15-4087-ace9-3167860cf6c7", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2025-05-06T11:31:56.672283Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "f20f30ab-fb15-4087-ace9-3167860cf6c7", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2025-05-06T11:31:56.691842Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:55.114178Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt deps", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'json', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:55.126608Z"}}
{"data": {"path": "/tmp/dbt-downloads-iwd43z42"}, "info": {"category": "", "code": "M028", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Set downloads directory='/tmp/dbt-downloads-iwd43z42'", "name": "DepsSetDownloadDirectory", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:57.730236Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M022", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json", "name": "RegistryIndexProgressGETRequest", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:57.734138Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/index.json"}, "info": {"category": "", "code": "M023", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200", "name": "RegistryIndexProgressGETResponse", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.452045Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json", "name": "RegistryProgressGETRequest", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.457608Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200", "name": "RegistryProgressGETResponse", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.539640Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json", "name": "RegistryProgressGETRequest", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.556248Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200", "name": "RegistryProgressGETResponse", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.647283Z"}}
{"data": {"url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M008", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json", "name": "RegistryProgressGETRequest", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.661500Z"}}
{"data": {"resp_code": 200, "url": "https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json"}, "info": {"category": "", "code": "M009", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200", "name": "RegistryProgressGETResponse", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.782524Z"}}
{"data": {"package_name": "dbt-labs/dbt_utils"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Installing dbt-labs/dbt_utils", "name": "DepsStartPackageInstall", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:10:58.797513Z"}}
{"data": {"version_name": "version 1.3.0"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Installed from version 1.3.0", "name": "DepsInstallInfo", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:12.084805Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:12.088795Z"}}
{"data": {"package_name": "metaplane/dbt_expectations"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Installing metaplane/dbt_expectations", "name": "DepsStartPackageInstall", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:12.092950Z"}}
{"data": {"version_name": "version 0.10.8"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Installed from version 0.10.8", "name": "DepsInstallInfo", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:19.886118Z"}}
{"data": {}, "info": {"category": "", "code": "M017", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Up to date!", "name": "DepsUpToDate", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:19.889835Z"}}
{"data": {"package_name": "godatadriven/dbt_date"}, "info": {"category": "", "code": "M014", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Installing godatadriven/dbt_date", "name": "DepsStartPackageInstall", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:19.893415Z"}}
{"data": {"version_name": "version 0.10.1"}, "info": {"category": "", "code": "M015", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Installed from version 0.10.1", "name": "DepsInstallInfo", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.026782Z"}}
{"data": {"version_latest": "0.12.0"}, "info": {"category": "", "code": "M016", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Updated version available: 0.12.0", "name": "DepsUpdateAvailable", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.032315Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "", "name": "Formatting", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.037568Z"}}
{"data": {"packages": ["godatadriven/dbt_date"]}, "info": {"category": "", "code": "M019", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "info", "msg": "Updates available for packages: ['godatadriven/dbt_date']                 \nUpdate your versions in packages.yml, then run dbt deps", "name": "DepsNotifyUpdatesAvailable", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.042580Z"}}
{"data": {"command_name": "deps", "command_success": true, "command_wall_clock_time": 29.160105, "process_in_blocks": "696", "process_kernel_time": 2.562171, "process_mem_max_rss": "101036", "process_out_blocks": "7568", "process_user_time": 5.103762}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Resource report: {\"command_name\": \"deps\", \"command_success\": true, \"command_wall_clock_time\": 29.160105, \"process_in_blocks\": \"696\", \"process_kernel_time\": 2.562171, \"process_mem_max_rss\": \"101036\", \"process_out_blocks\": \"7568\", \"process_user_time\": 5.103762}", "name": "ResourceReport", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.056970Z"}}
{"data": {"command": "dbt deps", "completed_at": "2025-05-06T13:11:24.063317Z", "elapsed": 29.167942, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Command `dbt deps` succeeded at 13:11:24.063317 after 29.17 seconds", "name": "CommandCompleted", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.064275Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "006c54d8-3f46-496d-9e00-6132d3c2adf8", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1945, "thread": "MainThread", "ts": "2025-05-06T13:11:24.069914Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:41.859999Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models player_boxscores --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'invocation_command': 'dbt run --models player_boxscores --fail-fast --debug --log-format=json', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:41.870846Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:42.841570Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:43.315828Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:53.708795Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:53.712610Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.324661Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.339627Z"}}
{"data": {"stat_line": "12 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "Found 12 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.407480Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "", "name": "Formatting", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.414949Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.419541Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "", "name": "Formatting", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.424989Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:11:54.431098Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:11:54.439251Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:11:54.559387Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:11:54.563193Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:11:54.567669Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:11:54.571626Z"}}
{"data": {"elapsed": 7.760438, "query_id": "20250506_091548_00000_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "SQL status: SUCCESS in 7.760 seconds", "name": "SQLQueryStatus", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:12:02.328117Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 1969, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:12:02.334676Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:02.365073Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:02.367033Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:02.543297Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:02.550980Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:02.555523Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:02.561269Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:02.566719Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:02.571655Z"}}
{"data": {"elapsed": 6.120808, "query_id": "20250506_091555_00002_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "SQL status: SUCCESS in 6.121 seconds", "name": "SQLQueryStatus", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:08.692509Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:08.715560Z"}}
{"data": {"elapsed": 6.152836, "query_id": "20250506_091555_00001_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "SQL status: SUCCESS in 6.153 seconds", "name": "SQLQueryStatus", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:08.719749Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 1969, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:12:08.746211Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:08.755364Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 1969, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:12:08.768636Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:08.775407Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Began running node model.nba_team_stats_project.player_boxscores", "name": "NodeStart", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.800062Z"}}
{"data": {"description": "sql view model iceberg_nba_player_boxscores.player_boxscores", "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "1 of 1 START sql view model iceberg_nba_player_boxscores.player_boxscores ...... [RUN]", "name": "LogStartLine", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.805831Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts, now model.nba_team_stats_project.player_boxscores)", "name": "ConnectionReused", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.812362Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.player_boxscores", "name": "NodeCompiling", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.819704Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.player_boxscores\"", "name": "WritingInjectedSQLForNode", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.838186Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.player_boxscores", "name": "NodeExecuting", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.865841Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.player_boxscores\"", "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.player_boxscores\"", "name": "JinjaLogDebug", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.949737Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "conn_type": "trino", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.player_boxscores\"", "name": "ConnectionUsed", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.982476Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On model.nba_team_stats_project.player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  ", "name": "SQLQuery", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.986986Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:08.992618Z"}}
{"data": {"elapsed": 9.795058, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "query_id": "20250506_091601_00003_4bm94", "status": "CREATE VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "SQL status: CREATE VIEW in 9.795 seconds", "name": "SQLQueryStatus", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:18.769307Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On model.nba_team_stats_project.player_boxscores: ROLLBACK", "name": "Rollback", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:18.837258Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On model.nba_team_stats_project.player_boxscores: Close", "name": "ConnectionClosed", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:18.841708Z"}}
{"data": {"description": "sql view model iceberg_nba_player_boxscores.player_boxscores", "execution_time": 10.036842, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2025-05-06T13:12:18.848502", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "status": "CREATE VIEW", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "1 of 1 OK created sql view model iceberg_nba_player_boxscores.player_boxscores . [\u001b[32mCREATE VIEW\u001b[0m in 10.04s]", "name": "LogModelResult", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:18.857074Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_finished_at": "2025-05-06T13:12:18.848502", "node_name": "player_boxscores", "node_path": "player_boxscores.sql", "node_relation": {"alias": "player_boxscores", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:12:08.799666", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.player_boxscores"}, "run_result": {"adapter_response": {"_message": "CREATE VIEW", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  ", "query_id": "20250506_091601_00003_4bm94", "rows_affected": -1.0}, "execution_time": 10.036842, "message": "CREATE VIEW", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T13:12:08.865321Z", "name": "compile", "started_at": "2025-05-06T13:12:08.824172Z"}, {"completed_at": "2025-05-06T13:12:18.836858Z", "name": "execute", "started_at": "2025-05-06T13:12:08.869823Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.player_boxscores", "name": "NodeFinished", "pid": 1969, "thread": "Thread-1", "ts": "2025-05-06T13:12:18.865449Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.875053Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.881045Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.888002Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.891192Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "", "name": "Formatting", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.895438Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 24.46 seconds", "execution_time": 24.46491, "stat_line": "1 view model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "Finished running 1 view model in 0 hours 0 minutes and 24.46 seconds (24.46s).", "name": "FinishedRunningStats", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.899514Z"}}
{"data": {"elapsed_time": 24.46491, "generated_at": "2025-05-06T13:12:18Z", "results": [{"adapter_response": {"_message": "CREATE VIEW", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.player_boxscores\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n  security definer\n  as\n    -- simple reference to the base table using 'view' materialization.\n\n\n\nSELECT\n    season_id,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    game_id,\n    game_date,\n    matchup,\n    win_loss,\n    minutes_played,\n    field_goals_made,\n    field_goals_attempted,\n\n    -- casts to ensure numeric/double type:\n    CAST(field_goal_percentage AS DOUBLE) AS field_goal_percentage,\n    three_point_field_goals_made,\n    three_point_field_goals_attempted,\n    CAST(three_point_field_goal_percentage AS DOUBLE) AS three_point_field_goal_percentage,\n    free_throws_made,\n    free_throws_attempted,\n    CAST(free_throw_percentage AS DOUBLE) AS free_throw_percentage,\n\n    offensive_rebounds,\n    defensive_rebounds,\n    rebounds,\n    assists,\n    steals,\n    blocks,\n    turnovers,\n    personal_fouls,\n    points,\n    plus_minus,\n    fantasy_points,\n    video_available,\n    season,\n    season_type,\n    year,\n    month,\n    day\n\nFROM iceberg_nba_player_boxscores.nba_player_boxscores\n  ", "query_id": "20250506_091601_00003_4bm94", "rows_affected": -1.0}, "execution_time": 10.036842, "message": "CREATE VIEW", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T13:12:08.865321Z", "name": "compile", "started_at": "2025-05-06T13:12:08.824172Z"}, {"completed_at": "2025-05-06T13:12:18.836858Z", "name": "execute", "started_at": "2025-05-06T13:12:08.869823Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:18.905861Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.142170Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.161707Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.210967Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "", "name": "Formatting", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.216240Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.221356Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "", "name": "Formatting", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.225833Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.230025Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.637814, "process_in_blocks": "176", "process_kernel_time": 1.322797, "process_mem_max_rss": "119176", "process_out_blocks": "96", "process_user_time": 6.78697}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 37.637814, \"process_in_blocks\": \"176\", \"process_kernel_time\": 1.322797, \"process_mem_max_rss\": \"119176\", \"process_out_blocks\": \"96\", \"process_user_time\": 6.78697}", "name": "ResourceReport", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.237518Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T13:12:19.241842Z", "elapsed": 37.642982, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Command `dbt run` succeeded at 13:12:19.241842 after 37.64 seconds", "name": "CommandCompleted", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.242598Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "626e1002-b56b-41cd-a8e7-d047e0bf7d9d", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 1969, "thread": "MainThread", "ts": "2025-05-06T13:12:19.248096Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:39.794311Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models dim_players_scd2 --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'json', 'introspect': 'True', 'invocation_command': 'dbt run --models dim_players_scd2 --fail-fast --debug --log-format=json', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:39.805395Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:40.747110Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:41.193777Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:50.836678Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:50.840519Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.443404Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.456907Z"}}
{"data": {"stat_line": "12 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "Found 12 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.498865Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "", "name": "Formatting", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.505365Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.509051Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "", "name": "Formatting", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.513113Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:51.518333Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.523634Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.633866Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.637429Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.641462Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.644764Z"}}
{"data": {"elapsed": 0.26331586, "query_id": "20250506_091744_00004_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: SUCCESS in 0.263 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.904759Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 2039, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:13:51.911390Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:51.933413Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:51.936158Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:52.011445Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:52.017119Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:52.021202Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:52.024753Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:52.029404Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:52.033448Z"}}
{"data": {"elapsed": 0.94195575, "query_id": "20250506_091744_00006_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: SUCCESS in 0.942 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:52.975408Z"}}
{"data": {"elapsed": 0.9500445, "query_id": "20250506_091744_00005_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: SUCCESS in 0.950 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:52.979270Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:52.985759Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:52.991602Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2039, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:13:52.996589Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 2039, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:13:53.001075Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:13:53.012573Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Began running node model.nba_team_stats_project.dim_players_scd2", "name": "NodeStart", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.024533Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd2", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.dim_players_scd2  [RUN]", "name": "LogStartLine", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.030526Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts, now model.nba_team_stats_project.dim_players_scd2)", "name": "ConnectionReused", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.036188Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.dim_players_scd2", "name": "NodeCompiling", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.040028Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.dim_players_scd2\"", "name": "WritingInjectedSQLForNode", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.073410Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.dim_players_scd2", "name": "NodeExecuting", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.093141Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.268860Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n  security definer\n  as\n    -- SCD Type 2 logic for Player Dimension\n\n\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n          Even though we only ultimately keep dimension columns,\n          we \"keep the structure\" and still select everything here.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if (player_id, season, game_id) repeats.\n          Again, we keep the flow, even though dimension-level logic won\u2019t rely on game-level data.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    /*\n       3) We keep this step as-is, though it's more relevant for fact data.\n          (You might remove it entirely for a pure dimension,\n           but here we keep it to honor \"keep all structure and flow the same\".)\n    */\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    /*\n       4) Compute a hash, but ONLY from the dimension attributes \n          we care about for SCD2 (e.g. player_id, player_name, team_id, team_abbreviation, team_name).\n          We remove game-level columns from the concatenation.\n    */\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    /*\n       5) Detect changes in the player's team (if you consider team part of the dimension).\n          We keep the same logic, but it\u2019s effectively how we split SCD blocks by team changes.\n    */\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    /*\n       6) Summation over the partition to identify each contiguous block of team affiliation.\n    */\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    /*\n       7) For each block, identify the earliest date (block_debut_date) and latest date (block_final_date).\n          We keep the \"structure\" even though we\u2019ll store only dimension data in final.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    /*\n       8) Final SELECT for the dimension table. \n          We remove all fact\u2010level columns (game_id, game_date, stats, etc.) \n          and keep only dimension columns plus SCD2 fields.\n    */\n    SELECT\n        -- Surrogate key for the new dimension version:\n        MD5(\n            to_utf8(\n                CONCAT(\n                    COALESCE(CAST(b.player_id AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.team_block AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.block_debut_date AS VARCHAR), '_null_')\n                )\n            )\n        ) AS player_scd_uk,       -- SCD2 Surrogate key (example)\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n\n        -- The row_hash from dimension attributes\n        b.row_hash,\n\n        -- SCD2 Effective date range\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        -- is_current (true if it's the last block for this player)\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        -- Auditing columns\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n-- In an incremental run, typically you'd load only changed data or none at all.\nSELECT * FROM final_data WHERE 1=0\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n  security definer\n  as\n    -- SCD Type 2 logic for Player Dimension\n\n\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n          Even though we only ultimately keep dimension columns,\n          we \"keep the structure\" and still select everything here.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row if (player_id, season, game_id) repeats.\n          Again, we keep the flow, even though dimension-level logic won\u2019t rely on game-level data.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    /*\n       3) We keep this step as-is, though it's more relevant for fact data.\n          (You might remove it entirely for a pure dimension,\n           but here we keep it to honor \"keep all structure and flow the same\".)\n    */\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    /*\n       4) Compute a hash, but ONLY from the dimension attributes \n          we care about for SCD2 (e.g. player_id, player_name, team_id, team_abbreviation, team_name).\n          We remove game-level columns from the concatenation.\n    */\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    /*\n       5) Detect changes in the player's team (if you consider team part of the dimension).\n          We keep the same logic, but it\u2019s effectively how we split SCD blocks by team changes.\n    */\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    /*\n       6) Summation over the partition to identify each contiguous block of team affiliation.\n    */\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    /*\n       7) For each block, identify the earliest date (block_debut_date) and latest date (block_final_date).\n          We keep the \"structure\" even though we\u2019ll store only dimension data in final.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    /*\n       8) Final SELECT for the dimension table. \n          We remove all fact\u2010level columns (game_id, game_date, stats, etc.) \n          and keep only dimension columns plus SCD2 fields.\n    */\n    SELECT\n        -- Surrogate key for the new dimension version:\n        MD5(\n            to_utf8(\n                CONCAT(\n                    COALESCE(CAST(b.player_id AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.team_block AS VARCHAR), '_null_'), '-',\n                    COALESCE(CAST(b.block_debut_date AS VARCHAR), '_null_')\n                )\n            )\n        ) AS player_scd_uk,       -- SCD2 Surrogate key (example)\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n\n        -- The row_hash from dimension attributes\n        b.row_hash,\n\n        -- SCD2 Effective date range\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n\n        -- is_current (true if it's the last block for this player)\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        -- Auditing columns\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n\n-- In an incremental run, typically you'd load only changed data or none at all.\nSELECT * FROM final_data WHERE 1=0\n\n  ", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.273640Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:53.280023Z"}}
{"data": {"elapsed": 2.0706112, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091746_00007_4bm94", "status": "CREATE VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: CREATE VIEW in 2.071 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:55.350626Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:55.392663Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2__dbt_tmp'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2__dbt_tmp'", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:55.397770Z"}}
{"data": {"elapsed": 0.52238107, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091748_00008_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: SUCCESS in 0.522 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:55.924368Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:55.944852Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:55.950040Z"}}
{"data": {"elapsed": 0.5988638, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091748_00009_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: SUCCESS in 0.599 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:56.554194Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:56.589761Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:56.595450Z"}}
{"data": {"elapsed": 0.5692995, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091749_00010_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: SUCCESS in 0.569 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:57.169572Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd2\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd2\"", "name": "JinjaLogDebug", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:57.214986Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:57.238584Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\ninsert into \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\" (\"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\")\n    (\n        select \"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\"\n        from \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\ninsert into \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\" (\"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\")\n    (\n        select \"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\"\n        from \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n    )", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:13:57.243622Z"}}
{"data": {"elapsed": 3.726489, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091750_00011_4bm94", "status": "INSERT (0 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: INSERT (0 rows) in 3.726 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:00.975783Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:01.002615Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:01.011458Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:01.018901Z"}}
{"data": {"elapsed": 1.3962084, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091753_00012_4bm94", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: DROP VIEW in 1.396 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:02.419154Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:02.429713Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp\n        )", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:02.434149Z"}}
{"data": {"elapsed": 5.3304286, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091755_00013_4bm94", "status": "DELETE (0 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: DELETE (0 rows) in 5.330 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:07.769747Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:07.781947Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        SELECT\n            player_scd_uk,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            row_hash,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"\n        SELECT\n            player_scd_uk,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            row_hash,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"__dbt_tmp", "name": "SQLQuery", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:07.788113Z"}}
{"data": {"elapsed": 44.84179, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_091800_00014_4bm94", "status": "INSERT (1_498_773 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "SQL status: INSERT (1_498_773 rows) in 44.842 seconds", "name": "SQLQueryStatus", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:52.597583Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: ROLLBACK", "name": "Rollback", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:52.677637Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: Close", "name": "ConnectionClosed", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:52.682994Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd2", "execution_time": 59.65182, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T13:14:52.687418", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "status": "INSERT (0 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.dim_players_scd2  [\u001b[32mINSERT (0 rows)\u001b[0m in 59.65s]", "name": "LogModelResult", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:52.692488Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T13:14:52.687418", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:13:53.024180", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "run_result": {"adapter_response": {"_message": "INSERT (0 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\ninsert into \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\" (\"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\")\n    (\n        select \"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\"\n        from \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n    )", "query_id": "20250506_091750_00011_4bm94", "rows_affected": 0.0}, "execution_time": 59.65182, "message": "INSERT (0 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T13:13:53.092489Z", "name": "compile", "started_at": "2025-05-06T13:13:53.043951Z"}, {"completed_at": "2025-05-06T13:14:52.677181Z", "name": "execute", "started_at": "2025-05-06T13:13:53.097779Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.dim_players_scd2", "name": "NodeFinished", "pid": 2039, "thread": "Thread-1", "ts": "2025-05-06T13:14:52.701142Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.712027Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.717438Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.dim_players_scd2' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.723137Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.730681Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "", "name": "Formatting", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.736976Z"}}
{"data": {"execution": " in 0 hours 1 minutes and 1.22 seconds", "execution_time": 61.218956, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 1 minutes and 1.22 seconds (61.22s).", "name": "FinishedRunningStats", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.748736Z"}}
{"data": {"elapsed_time": 61.218956, "generated_at": "2025-05-06T13:14:52Z", "results": [{"adapter_response": {"_message": "INSERT (0 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\ninsert into \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\" (\"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\")\n    (\n        select \"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\"\n        from \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n    )", "query_id": "20250506_091750_00011_4bm94", "rows_affected": 0.0}, "execution_time": 59.65182, "message": "INSERT (0 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T13:13:53.092489Z", "name": "compile", "started_at": "2025-05-06T13:13:53.043951Z"}, {"completed_at": "2025-05-06T13:14:52.677181Z", "name": "execute", "started_at": "2025-05-06T13:13:53.097779Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:52.757432Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.176795Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.196390Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.233893Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "", "name": "Formatting", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.243968Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.249115Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "", "name": "Formatting", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.253816Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.258667Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 73.71071, "process_in_blocks": "0", "process_kernel_time": 1.367596, "process_mem_max_rss": "119512", "process_out_blocks": "8", "process_user_time": 6.655634}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 73.71071, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.367596, \"process_mem_max_rss\": \"119512\", \"process_out_blocks\": \"8\", \"process_user_time\": 6.655634}", "name": "ResourceReport", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.266268Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T13:14:53.270650Z", "elapsed": 73.7161, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Command `dbt run` succeeded at 13:14:53.270650 after 73.72 seconds", "name": "CommandCompleted", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.271273Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "3bf95551-a6c8-4590-ac04-ec548654d682", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 2039, "thread": "MainThread", "ts": "2025-05-06T13:14:53.276112Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:22.533815Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models dim_teams_scd2 --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'invocation_command': 'dbt run --models dim_teams_scd2 --fail-fast --debug --log-format=json', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:22.545586Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:23.520834Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:23.936140Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.135617Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.139415Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.819604Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.833739Z"}}
{"data": {"stat_line": "12 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "Found 12 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.898837Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "", "name": "Formatting", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.911472Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.916191Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "", "name": "Formatting", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.920879Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:34.925314Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:34.931177Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:35.064012Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:35.069271Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:35.074452Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:35.080350Z"}}
{"data": {"elapsed": 0.16669658, "query_id": "20250506_092128_00015_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: SUCCESS in 0.167 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:35.241149Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 2129, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T13:17:35.247660Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores)", "name": "ConnectionReused", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.274917Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "NewConnection", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.277148Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.380195Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.381386Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.386897Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.391306Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.395387Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.400101Z"}}
{"data": {"elapsed": 0.5016989, "query_id": "20250506_092128_00016_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: SUCCESS in 0.502 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.897178Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.903859Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 2129, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T13:17:35.911661Z"}}
{"data": {"elapsed": 0.520006, "query_id": "20250506_092128_00017_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: SUCCESS in 0.520 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.919953Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.928043Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 2129, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T13:17:35.931921Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:35.944801Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Began running node model.nba_team_stats_project.dim_teams_scd2", "name": "NodeStart", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:35.968337Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_teams_scd2", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.dim_teams_scd2 . [RUN]", "name": "LogStartLine", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:35.973758Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.dim_teams_scd2)", "name": "ConnectionReused", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:35.978050Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.dim_teams_scd2", "name": "NodeCompiling", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:35.982440Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.dim_teams_scd2\"", "name": "WritingInjectedSQLForNode", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:36.012241Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.dim_teams_scd2", "name": "NodeExecuting", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:36.029806Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_teams_scd2\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_teams_scd2\"", "name": "JinjaLogDebug", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:36.202394Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_teams_scd2\"", "name": "ConnectionUsed", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:36.253352Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n      \n      \n    as (\n      -- =====================================================================\n-- SCD Type 2 logic for TEAM DIMENSION\n-- (Tracks team attributes only; no game-level or fact data)\n-- =====================================================================\n\n\n\n\nWITH base AS (\n    /*\n      1) Pull only the TEAM-LEVEL attributes + game_date (used for detecting changes over time).\n         Drop all fact-level columns (season, matchup, points, etc.).\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        -- Keep game_date ONLY to help identify the time windows for changes\n        t.game_date\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n\nhash_calc AS (\n    /*\n      2) Compute a row_hash for change detection (only dimension attributes).\n         We do NOT include game_date or other fact fields in the hash, \n         since the dimension changes only when team attributes change.\n    */\n    SELECT\n        base.team_id,\n        base.team_name,\n        base.team_abbreviation,\n        base.game_date,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\nflag_new_block AS (\n    /*\n      3) Detect new SCD block whenever (team_name, team_abbreviation) \n         differs from the prior row for the same team_id.\n    */\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date)     AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    /*\n      4) Mark a row as 'new_block_flag=1' if the dimension attributes\n         differ from the previous row (i.e., an actual change in team name or abbreviation).\n    */\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name      = f.team_name\n             AND f.prev_team_abbrev    = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\nblocks AS (\n    /*\n      5) Within each team_id, do a cumulative sum of new_block_flag => block_id\n         to group contiguous spans of the same dimension attribute values.\n    */\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\nblock_date_ranges AS (\n    /*\n      6) For each block, find the earliest (MIN) and latest (MAX) game_date in that block.\n      -- We'll treat those as the dimension's validity window: debut_date, final_date.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\nwith_next_block AS (\n    /*\n      7) Look ahead to see if there's a \"next block\" start date, for closing out the current block's validity window.\n    */\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd\n    FROM base\n),\n\nteam_activity AS (\n    /*\n      8) Identify whether a team is still active (based on having the max game_date).\n         If it has the overall max, we mark that row as is_current=TRUE\n         unless there's already a \"next block\" start date for it.\n    */\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date) THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\nfinal_data AS (\n    /*\n      9) Assemble final dimension data. \n         - The SCD validity window is [block_debut_date, block_final_date].\n         - We do not include any fact-level fields (game stats, etc.).\n         - We generate a unique surrogate key: team_scd_uk.\n         - We set is_current based on presence/absence of next_block_start or team still active.\n    */\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Surrogate key example: \"teamId_blockId_blockDebutDate\"\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n    /*\n      On a full run, load everything from final_data.\n    */\n    SELECT\n        team_id,\n        team_name,\n        team_abbreviation,\n        debut_date,\n        final_date,\n        is_current,\n        row_hash,\n        team_scd_uk,\n        record_created_timestamp,\n        record_updated_timestamp,\n        record_updated_by\n    FROM final_data\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On model.nba_team_stats_project.dim_teams_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n      \n      \n    as (\n      -- =====================================================================\n-- SCD Type 2 logic for TEAM DIMENSION\n-- (Tracks team attributes only; no game-level or fact data)\n-- =====================================================================\n\n\n\n\nWITH base AS (\n    /*\n      1) Pull only the TEAM-LEVEL attributes + game_date (used for detecting changes over time).\n         Drop all fact-level columns (season, matchup, points, etc.).\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        -- Keep game_date ONLY to help identify the time windows for changes\n        t.game_date\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n\nhash_calc AS (\n    /*\n      2) Compute a row_hash for change detection (only dimension attributes).\n         We do NOT include game_date or other fact fields in the hash, \n         since the dimension changes only when team attributes change.\n    */\n    SELECT\n        base.team_id,\n        base.team_name,\n        base.team_abbreviation,\n        base.game_date,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\nflag_new_block AS (\n    /*\n      3) Detect new SCD block whenever (team_name, team_abbreviation) \n         differs from the prior row for the same team_id.\n    */\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date)     AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    /*\n      4) Mark a row as 'new_block_flag=1' if the dimension attributes\n         differ from the previous row (i.e., an actual change in team name or abbreviation).\n    */\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name      = f.team_name\n             AND f.prev_team_abbrev    = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\nblocks AS (\n    /*\n      5) Within each team_id, do a cumulative sum of new_block_flag => block_id\n         to group contiguous spans of the same dimension attribute values.\n    */\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\nblock_date_ranges AS (\n    /*\n      6) For each block, find the earliest (MIN) and latest (MAX) game_date in that block.\n      -- We'll treat those as the dimension's validity window: debut_date, final_date.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\nwith_next_block AS (\n    /*\n      7) Look ahead to see if there's a \"next block\" start date, for closing out the current block's validity window.\n    */\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd\n    FROM base\n),\n\nteam_activity AS (\n    /*\n      8) Identify whether a team is still active (based on having the max game_date).\n         If it has the overall max, we mark that row as is_current=TRUE\n         unless there's already a \"next block\" start date for it.\n    */\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date) THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\nfinal_data AS (\n    /*\n      9) Assemble final dimension data. \n         - The SCD validity window is [block_debut_date, block_final_date].\n         - We do not include any fact-level fields (game stats, etc.).\n         - We generate a unique surrogate key: team_scd_uk.\n         - We set is_current based on presence/absence of next_block_start or team still active.\n    */\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Surrogate key example: \"teamId_blockId_blockDebutDate\"\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n    /*\n      On a full run, load everything from final_data.\n    */\n    SELECT\n        team_id,\n        team_name,\n        team_abbreviation,\n        debut_date,\n        final_date,\n        is_current,\n        row_hash,\n        team_scd_uk,\n        record_created_timestamp,\n        record_updated_timestamp,\n        record_updated_by\n    FROM final_data\n\n    )", "name": "SQLQuery", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:36.257805Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:36.264115Z"}}
{"data": {"elapsed": 16.37802, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "query_id": "20250506_092129_00018_4bm94", "status": "CREATE TABLE (147_143 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: CREATE TABLE (147_143 rows) in 16.378 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.624715Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.648561Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_teams_scd2\"", "name": "ConnectionUsed", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.658785Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On model.nba_team_stats_project.dim_teams_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2__dbt_tmp\"", "name": "SQLQuery", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.662947Z"}}
{"data": {"elapsed": 0.0397632, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "query_id": "20250506_092145_00019_4bm94", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: DROP VIEW in 0.040 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.707723Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_teams_scd2\"", "name": "ConnectionUsed", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.721750Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n        WHERE team_scd_uk IN (\n            SELECT team_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"__dbt_tmp\n        )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On model.nba_team_stats_project.dim_teams_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n        WHERE team_scd_uk IN (\n            SELECT team_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"__dbt_tmp\n        )", "name": "SQLQuery", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:52.727876Z"}}
{"data": {"elapsed": 1.3118879, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "query_id": "20250506_092145_00020_4bm94", "status": "DELETE (0 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: DELETE (0 rows) in 1.312 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:54.044115Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_teams_scd2\"", "name": "ConnectionUsed", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:54.056151Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n        SELECT\n            team_id,\n            team_name,\n            team_abbreviation,\n            debut_date,\n            final_date,\n            is_current,\n            row_hash,\n            team_scd_uk,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"__dbt_tmp"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On model.nba_team_stats_project.dim_teams_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n        SELECT\n            team_id,\n            team_name,\n            team_abbreviation,\n            debut_date,\n            final_date,\n            is_current,\n            row_hash,\n            team_scd_uk,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"__dbt_tmp", "name": "SQLQuery", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:54.060792Z"}}
{"data": {"elapsed": 4.154614, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "query_id": "20250506_092147_00021_4bm94", "status": "INSERT (147_143 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "SQL status: INSERT (147_143 rows) in 4.155 seconds", "name": "SQLQueryStatus", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:58.221940Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On model.nba_team_stats_project.dim_teams_scd2: ROLLBACK", "name": "Rollback", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:58.269080Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On model.nba_team_stats_project.dim_teams_scd2: Close", "name": "ConnectionClosed", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:58.274124Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_teams_scd2", "execution_time": 22.301413, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T13:17:58.278897", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "status": "CREATE TABLE (147_143 rows)", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "1 of 1 OK created sql incremental model iceberg_nba_player_boxscores.dim_teams_scd2  [\u001b[32mCREATE TABLE (147_143 rows)\u001b[0m in 22.30s]", "name": "LogModelResult", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:58.282892Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T13:17:58.278897", "node_name": "dim_teams_scd2", "node_path": "dim_teams_scd2.sql", "node_relation": {"alias": "dim_teams_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T13:17:35.967635", "node_status": "success", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_teams_scd2"}, "run_result": {"adapter_response": {"_message": "CREATE TABLE (147_143 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n      \n      \n    as (\n      -- =====================================================================\n-- SCD Type 2 logic for TEAM DIMENSION\n-- (Tracks team attributes only; no game-level or fact data)\n-- =====================================================================\n\n\n\n\nWITH base AS (\n    /*\n      1) Pull only the TEAM-LEVEL attributes + game_date (used for detecting changes over time).\n         Drop all fact-level columns (season, matchup, points, etc.).\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        -- Keep game_date ONLY to help identify the time windows for changes\n        t.game_date\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n\nhash_calc AS (\n    /*\n      2) Compute a row_hash for change detection (only dimension attributes).\n         We do NOT include game_date or other fact fields in the hash, \n         since the dimension changes only when team attributes change.\n    */\n    SELECT\n        base.team_id,\n        base.team_name,\n        base.team_abbreviation,\n        base.game_date,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\nflag_new_block AS (\n    /*\n      3) Detect new SCD block whenever (team_name, team_abbreviation) \n         differs from the prior row for the same team_id.\n    */\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date)     AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    /*\n      4) Mark a row as 'new_block_flag=1' if the dimension attributes\n         differ from the previous row (i.e., an actual change in team name or abbreviation).\n    */\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name      = f.team_name\n             AND f.prev_team_abbrev    = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\nblocks AS (\n    /*\n      5) Within each team_id, do a cumulative sum of new_block_flag => block_id\n         to group contiguous spans of the same dimension attribute values.\n    */\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\nblock_date_ranges AS (\n    /*\n      6) For each block, find the earliest (MIN) and latest (MAX) game_date in that block.\n      -- We'll treat those as the dimension's validity window: debut_date, final_date.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\nwith_next_block AS (\n    /*\n      7) Look ahead to see if there's a \"next block\" start date, for closing out the current block's validity window.\n    */\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd\n    FROM base\n),\n\nteam_activity AS (\n    /*\n      8) Identify whether a team is still active (based on having the max game_date).\n         If it has the overall max, we mark that row as is_current=TRUE\n         unless there's already a \"next block\" start date for it.\n    */\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date) THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\nfinal_data AS (\n    /*\n      9) Assemble final dimension data. \n         - The SCD validity window is [block_debut_date, block_final_date].\n         - We do not include any fact-level fields (game stats, etc.).\n         - We generate a unique surrogate key: team_scd_uk.\n         - We set is_current based on presence/absence of next_block_start or team still active.\n    */\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Surrogate key example: \"teamId_blockId_blockDebutDate\"\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n    /*\n      On a full run, load everything from final_data.\n    */\n    SELECT\n        team_id,\n        team_name,\n        team_abbreviation,\n        debut_date,\n        final_date,\n        is_current,\n        row_hash,\n        team_scd_uk,\n        record_created_timestamp,\n        record_updated_timestamp,\n        record_updated_by\n    FROM final_data\n\n    )", "query_id": "20250506_092129_00018_4bm94", "rows_affected": 147143.0}, "execution_time": 22.301413, "message": "CREATE TABLE (147_143 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T13:17:36.029311Z", "name": "compile", "started_at": "2025-05-06T13:17:35.986735Z"}, {"completed_at": "2025-05-06T13:17:58.268577Z", "name": "execute", "started_at": "2025-05-06T13:17:36.033779Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.dim_teams_scd2", "name": "NodeFinished", "pid": 2129, "thread": "Thread-1", "ts": "2025-05-06T13:17:58.288323Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.296146Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.300641Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_teams_scd2"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.dim_teams_scd2' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.304782Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.309233Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "", "name": "Formatting", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.312634Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 23.39 seconds", "execution_time": 23.387848, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 23.39 seconds (23.39s).", "name": "FinishedRunningStats", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.316376Z"}}
{"data": {"elapsed_time": 23.387848, "generated_at": "2025-05-06T13:17:58Z", "results": [{"adapter_response": {"_message": "CREATE TABLE (147_143 rows)", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_teams_scd2\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_teams_scd2\"\n      \n      \n    as (\n      -- =====================================================================\n-- SCD Type 2 logic for TEAM DIMENSION\n-- (Tracks team attributes only; no game-level or fact data)\n-- =====================================================================\n\n\n\n\nWITH base AS (\n    /*\n      1) Pull only the TEAM-LEVEL attributes + game_date (used for detecting changes over time).\n         Drop all fact-level columns (season, matchup, points, etc.).\n    */\n    SELECT\n        t.team_id,\n        t.team_name,\n        t.team_abbreviation,\n\n        -- Keep game_date ONLY to help identify the time windows for changes\n        t.game_date\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"team_boxscores\" t\n),\n\n\nhash_calc AS (\n    /*\n      2) Compute a row_hash for change detection (only dimension attributes).\n         We do NOT include game_date or other fact fields in the hash, \n         since the dimension changes only when team attributes change.\n    */\n    SELECT\n        base.team_id,\n        base.team_name,\n        base.team_abbreviation,\n        base.game_date,\n        MD5(\n          to_utf8(\n            CONCAT(\n                COALESCE(CAST(base.team_id AS VARCHAR), '_null_'), '-',\n                COALESCE(base.team_name, '_null_'), '-',\n                COALESCE(base.team_abbreviation, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM base\n),\n\nflag_new_block AS (\n    /*\n      3) Detect new SCD block whenever (team_name, team_abbreviation) \n         differs from the prior row for the same team_id.\n    */\n    SELECT\n        h.*,\n        LAG(h.team_name) OVER (PARTITION BY h.team_id ORDER BY h.game_date)     AS prev_team_name,\n        LAG(h.team_abbreviation) OVER (PARTITION BY h.team_id ORDER BY h.game_date) AS prev_team_abbrev\n    FROM hash_calc h\n),\n\nidentify_blocks AS (\n    /*\n      4) Mark a row as 'new_block_flag=1' if the dimension attributes\n         differ from the previous row (i.e., an actual change in team name or abbreviation).\n    */\n    SELECT\n        f.*,\n        CASE\n            WHEN f.prev_team_name      = f.team_name\n             AND f.prev_team_abbrev    = f.team_abbreviation\n            THEN 0\n            ELSE 1\n        END AS new_block_flag\n    FROM flag_new_block f\n),\n\nblocks AS (\n    /*\n      5) Within each team_id, do a cumulative sum of new_block_flag => block_id\n         to group contiguous spans of the same dimension attribute values.\n    */\n    SELECT\n        i.*,\n        SUM(new_block_flag) OVER (\n            PARTITION BY i.team_id\n            ORDER BY i.game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS block_id\n    FROM identify_blocks i\n),\n\nblock_date_ranges AS (\n    /*\n      6) For each block, find the earliest (MIN) and latest (MAX) game_date in that block.\n      -- We'll treat those as the dimension's validity window: debut_date, final_date.\n    */\n    SELECT\n        b.*,\n        MIN(game_date) OVER (PARTITION BY team_id, block_id) AS block_debut_date,\n        MAX(game_date) OVER (PARTITION BY team_id, block_id) AS block_final_date\n    FROM blocks b\n),\n\nwith_next_block AS (\n    /*\n      7) Look ahead to see if there's a \"next block\" start date, for closing out the current block's validity window.\n    */\n    SELECT\n        block_date_ranges.*,\n        LEAD(block_debut_date) OVER (\n            PARTITION BY team_id\n            ORDER BY block_debut_date\n        ) AS next_block_start\n    FROM block_date_ranges\n),\n\nmax_game_date AS (\n    SELECT MAX(game_date) AS max_gd\n    FROM base\n),\n\nteam_activity AS (\n    /*\n      8) Identify whether a team is still active (based on having the max game_date).\n         If it has the overall max, we mark that row as is_current=TRUE\n         unless there's already a \"next block\" start date for it.\n    */\n    SELECT\n        b.team_id,\n        CASE\n            WHEN MAX(b.game_date) = (SELECT max_gd FROM max_game_date) THEN 1\n            ELSE 0\n        END AS is_still_active\n    FROM base b\n    GROUP BY b.team_id\n),\n\nfinal_data AS (\n    /*\n      9) Assemble final dimension data. \n         - The SCD validity window is [block_debut_date, block_final_date].\n         - We do not include any fact-level fields (game stats, etc.).\n         - We generate a unique surrogate key: team_scd_uk.\n         - We set is_current based on presence/absence of next_block_start or team still active.\n    */\n    SELECT\n        w.team_id,\n        w.team_name,\n        w.team_abbreviation,\n\n        w.block_debut_date AS debut_date,\n        w.block_final_date AS final_date,\n\n        CASE\n            WHEN w.next_block_start IS NOT NULL THEN FALSE\n            WHEN a.is_still_active = 1 THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n\n        w.row_hash,\n\n        -- Surrogate key example: \"teamId_blockId_blockDebutDate\"\n        CONCAT(\n            CAST(w.team_id AS VARCHAR), '_',\n            CAST(w.block_id AS VARCHAR), '_',\n            CAST(w.block_debut_date AS VARCHAR)\n        ) AS team_scd_uk,\n\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM with_next_block w\n    LEFT JOIN team_activity a\n           ON w.team_id = a.team_id\n)\n\n\n\n    /*\n      On a full run, load everything from final_data.\n    */\n    SELECT\n        team_id,\n        team_name,\n        team_abbreviation,\n        debut_date,\n        final_date,\n        is_current,\n        row_hash,\n        team_scd_uk,\n        record_created_timestamp,\n        record_updated_timestamp,\n        record_updated_by\n    FROM final_data\n\n    )", "query_id": "20250506_092129_00018_4bm94", "rows_affected": 147143.0}, "execution_time": 22.301413, "message": "CREATE TABLE (147_143 rows)", "num_failures": 0, "status": "success", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T13:17:36.029311Z", "name": "compile", "started_at": "2025-05-06T13:17:35.986735Z"}, {"completed_at": "2025-05-06T13:17:58.268577Z", "name": "execute", "started_at": "2025-05-06T13:17:36.033779Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.322014Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.549491Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.565814Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.603012Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "", "name": "Formatting", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.608006Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.611717Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "", "name": "Formatting", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.615555Z"}}
{"data": {"stats": {"error": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.620482Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.290646, "process_in_blocks": "24", "process_kernel_time": 1.312835, "process_mem_max_rss": "120520", "process_out_blocks": "8", "process_user_time": 6.802873}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 36.290646, \"process_in_blocks\": \"24\", \"process_kernel_time\": 1.312835, \"process_mem_max_rss\": \"120520\", \"process_out_blocks\": \"8\", \"process_user_time\": 6.802873}", "name": "ResourceReport", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.627395Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T13:17:58.631509Z", "elapsed": 36.29556, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Command `dbt run` succeeded at 13:17:58.631509 after 36.30 seconds", "name": "CommandCompleted", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.631939Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "79f38fcc-ff84-4db0-9a4a-c1189f557c46", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 2129, "thread": "MainThread", "ts": "2025-05-06T13:17:58.636689Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:28:46.175644Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models dim_players_scd2 --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'json', 'invocation_command': 'dbt run --models dim_players_scd2 --fail-fast --debug --log-format=json', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:28:46.187049Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:28:47.476704Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:28:47.977580Z"}}
{"data": {"added": 0, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:28:58.812421Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/dim_players_scd2.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/dim_players_scd2.sql", "name": "PartialParsingFile", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:28:58.816704Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.005799Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.023198Z"}}
{"data": {"stat_line": "12 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "Found 12 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.078980Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.086488Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.091188Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.094915Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:00.099236Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.106892Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.277481Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.281435Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.285065Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.288551Z"}}
{"data": {"elapsed": 0.25406206, "query_id": "20250506_113313_00028_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: SUCCESS in 0.254 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.539130Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 4720, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:29:00.545036Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:00.565597Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:00.568362Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:00.656599Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:00.654639Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:00.662084Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:00.665559Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:00.669282Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:00.673380Z"}}
{"data": {"elapsed": 0.58357495, "query_id": "20250506_113314_00029_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: SUCCESS in 0.584 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:01.252853Z"}}
{"data": {"elapsed": 0.58252794, "query_id": "20250506_113314_00030_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: SUCCESS in 0.583 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:01.255883Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:01.260633Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:01.267025Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 4720, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:29:01.271515Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 4720, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:29:01.275281Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:01.290069Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Began running node model.nba_team_stats_project.dim_players_scd2", "name": "NodeStart", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.303105Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd2", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.dim_players_scd2  [RUN]", "name": "LogStartLine", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.307528Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.dim_players_scd2)", "name": "ConnectionReused", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.311891Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.dim_players_scd2", "name": "NodeCompiling", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.315928Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.dim_players_scd2\"", "name": "WritingInjectedSQLForNode", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.343398Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.dim_players_scd2", "name": "NodeExecuting", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.362873Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.583850Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n  security definer\n  as\n    -- =======================\n-- player_boxscores_scd2.sql\n-- =======================\n\n-- SCD Type 2 logic for player boxscores\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row\n          if (player_id, season, game_id) repeats.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS field_goal_percentage,\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.three_point_field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS three_point_field_goal_percentage,\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.free_throw_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS free_throw_percentage,\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n-- =====================================================================\n-- Only change: select the SCD2 columns explicitly for final output\n-- =====================================================================\n\nSELECT\n    player_season_game_uk,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    row_hash,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\nWHERE 1=0\n\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n  create or replace view\n    \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n  security definer\n  as\n    -- =======================\n-- player_boxscores_scd2.sql\n-- =======================\n\n-- SCD Type 2 logic for player boxscores\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row\n          if (player_id, season, game_id) repeats.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS field_goal_percentage,\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.three_point_field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS three_point_field_goal_percentage,\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.free_throw_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS free_throw_percentage,\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_season_game_uk,\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n-- =====================================================================\n-- Only change: select the SCD2 columns explicitly for final output\n-- =====================================================================\n\nSELECT\n    player_season_game_uk,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    row_hash,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\nWHERE 1=0\n\n  ", "name": "SQLQuery", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.588434Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:01.594810Z"}}
{"data": {"elapsed": 1.4411837, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_113315_00031_4bm94", "status": "CREATE VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: CREATE VIEW in 1.441 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.035906Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.071107Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2__dbt_tmp'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2__dbt_tmp'", "name": "SQLQuery", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.075448Z"}}
{"data": {"elapsed": 0.16059776, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_113316_00032_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: SUCCESS in 0.161 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.240269Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.256343Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'", "name": "SQLQuery", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.260667Z"}}
{"data": {"elapsed": 0.4880254, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_113316_00033_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: SUCCESS in 0.488 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.752797Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.781254Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\n\n    select column_name, data_type\n    from \"iceberg\".INFORMATION_SCHEMA.columns\n    where\n      table_catalog = 'iceberg'\n      and table_schema = 'iceberg_nba_player_boxscores'\n      and table_name = 'dim_players_scd2'", "name": "SQLQuery", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:03.785601Z"}}
{"data": {"elapsed": 0.41344714, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "query_id": "20250506_113317_00034_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "SQL status: SUCCESS in 0.413 seconds", "name": "SQLQueryStatus", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:04.203582Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd2\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd2\"", "name": "JinjaLogDebug", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:04.237500Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd2\"", "name": "ConnectionUsed", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:04.261057Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\ninsert into \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\" (\"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\")\n    (\n        select \"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\"\n        from \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd2\"} */\ninsert into \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\" (\"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\")\n    (\n        select \"player_scd_uk\", \"player_id\", \"player_name\", \"team_id\", \"team_abbreviation\", \"team_name\", \"row_hash\", \"debut_date\", \"final_date\", \"is_current\", \"record_created_timestamp\", \"record_updated_timestamp\", \"record_updated_by\"\n        from \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2__dbt_tmp\"\n    )", "name": "SQLQuery", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:04.265885Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250506_113317_00035_4bm94", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Trino adapter: Trino query id: 20250506_113317_00035_4bm94", "name": "AdapterEventDebug", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.043960Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)", "name": "AdapterEventDebug", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.047991Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: ROLLBACK", "name": "Rollback", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.052657Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd2: Close", "name": "ConnectionClosed", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.056313Z"}}
{"data": {"exc": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 629, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 189, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "name": "CatchableExceptionOnRun", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.080849Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd2", "execution_time": 3.7740297, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T15:29:05.085353", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.dim_players_scd2  [\u001b[31mERROR\u001b[0m in 3.77s]", "name": "LogModelResult", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.089907Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T15:29:05.085353", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:29:01.302704", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "run_result": {"adapter_response": {}, "execution_time": 3.7740297, "message": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:29:01.362405Z", "name": "compile", "started_at": "2025-05-06T15:29:01.320477Z"}, {"completed_at": "2025-05-06T15:29:05.052282Z", "name": "execute", "started_at": "2025-05-06T15:29:01.367286Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.dim_players_scd2", "name": "NodeFinished", "pid": 4720, "thread": "Thread-1", "ts": "2025-05-06T15:29:05.095118Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 3.7740297, "message": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:29:01.362405Z", "name": "compile", "started_at": "2025-05-06T15:29:01.320477Z"}, {"completed_at": "2025-05-06T15:29:05.052282Z", "name": "execute", "started_at": "2025-05-06T15:29:01.367286Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.dim_players_scd2' to be skipped because of status 'error'.  Reason: Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql.", "name": "MarkSkippedChildren", "pid": 4720, "thread": "Thread-7", "ts": "2025-05-06T15:29:05.101575Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts  [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.108025Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.dim_players_scd2 ..................... [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.113102Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.117847Z"}}
{"data": {"msg": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "error", "msg": "  Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "name": "RunResultError", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.121731Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.125802Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.130608Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.134241Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd2"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.dim_players_scd2' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.137654Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.142067Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 5.04 seconds", "execution_time": 5.0433025, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 0 minutes and 5.04 seconds (5.04s).", "name": "FinishedRunningStats", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.146476Z"}}
{"data": {"elapsed_time": 5.0433025, "generated_at": "2025-05-06T15:29:05Z", "results": [{"adapter_response": {}, "execution_time": 3.7740297, "message": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:29:01.362405Z", "name": "compile", "started_at": "2025-05-06T15:29:01.320477Z"}, {"completed_at": "2025-05-06T15:29:05.052282Z", "name": "execute", "started_at": "2025-05-06T15:29:01.367286Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.152373Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.374938Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.390698Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.447591Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.453478Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.457824Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.463173Z"}}
{"data": {"msg": "Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd2", "node_path": "dim_players_scd2.sql", "node_relation": {"alias": "dim_players_scd2", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd2\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd2"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "error", "msg": "  Database Error in model dim_players_scd2 (NBA_models/dim_players_scd2.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 4:16: Column 'player_scd_uk' cannot be resolved\", query_id=20250506_113317_00035_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd2.sql", "name": "RunResultError", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.467982Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "", "name": "Formatting", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.481082Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.486102Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.64849, "process_in_blocks": "88", "process_kernel_time": 1.699253, "process_mem_max_rss": "125208", "process_out_blocks": "8", "process_user_time": 7.144587}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 19.64849, \"process_in_blocks\": \"88\", \"process_kernel_time\": 1.699253, \"process_mem_max_rss\": \"125208\", \"process_out_blocks\": \"8\", \"process_user_time\": 7.144587}", "name": "ResourceReport", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.493330Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T15:29:05.498902Z", "elapsed": 19.655058, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Command `dbt run` failed at 15:29:05.498902 after 19.66 seconds", "name": "CommandCompleted", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.499468Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "e1cc9db3-502d-4ae3-858a-5e3bafab83cd", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 4720, "thread": "MainThread", "ts": "2025-05-06T15:29:05.503655Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:08.297110Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models dim_players_scd3 --fail-fast --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models dim_players_scd3 --fail-fast --debug --log-format=json', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'json', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:08.310020Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:09.560748Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:10.078476Z"}}
{"data": {"added": 1, "changed": 1, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.", "name": "PartialParsingEnabled", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:19.988536Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/dim_players_scd3.sql", "operation": "added"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Partial parsing: added file: nba_team_stats_project://NBA_models/dim_players_scd3.sql", "name": "PartialParsingFile", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:19.992684Z"}}
{"data": {"file_id": "nba_team_stats_project://NBA_models/dim_players_scd2.sql", "operation": "updated"}, "info": {"category": "", "code": "I041", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Partial parsing: updated file: nba_team_stats_project://NBA_models/dim_players_scd2.sql", "name": "PartialParsingFile", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:19.997023Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.454385Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.467714Z"}}
{"data": {"stat_line": "13 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "Found 13 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.522286Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.536122Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.547169Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.551695Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:21.561035Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.570058Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.722642Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.727054Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.732446Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.737275Z"}}
{"data": {"elapsed": 0.22492185, "query_id": "20250506_113837_00036_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "SQL status: SUCCESS in 0.225 seconds", "name": "SQLQueryStatus", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.957299Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 4853, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:34:21.963956Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts)", "name": "ConnectionReused", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:22.008489Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores'", "name": "NewConnection", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:22.011734Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:22.116464Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:22.114898Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:22.123029Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:22.127036Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:22.131980Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:22.138011Z"}}
{"data": {"elapsed": 0.95377594, "query_id": "20250506_113837_00037_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "SQL status: SUCCESS in 0.954 seconds", "name": "SQLQueryStatus", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:23.085805Z"}}
{"data": {"elapsed": 0.9514646, "query_id": "20250506_113837_00038_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "SQL status: SUCCESS in 0.951 seconds", "name": "SQLQueryStatus", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:23.089398Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:23.094214Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:23.101204Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 4853, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:34:23.105243Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 4853, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:34:23.108749Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:34:23.122078Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Began running node model.nba_team_stats_project.dim_players_scd3", "name": "NodeStart", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.139199Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd3", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.dim_players_scd3  [RUN]", "name": "LogStartLine", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.144165Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores, now model.nba_team_stats_project.dim_players_scd3)", "name": "ConnectionReused", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.150033Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.dim_players_scd3", "name": "NodeCompiling", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.154741Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.dim_players_scd3\"", "name": "WritingInjectedSQLForNode", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.188199Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.dim_players_scd3", "name": "NodeExecuting", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.210259Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd3\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd3\"", "name": "JinjaLogDebug", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.465749Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.576783Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n      \n      \n    as (\n      -- =======================\n-- player_boxscores_scd2.sql\n-- =======================\n\n-- SCD Type 2 logic for player boxscores\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row\n          if (player_id, season, game_id) repeats.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS field_goal_percentage,\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.three_point_field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS three_point_field_goal_percentage,\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.free_throw_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS free_throw_percentage,\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_scd_uk,\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n-- =====================================================================\n-- Only change: select the SCD2 columns explicitly for final output\n-- =====================================================================\n\nSELECT\n    player_scd_uk,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    row_hash,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n      \n      \n    as (\n      -- =======================\n-- player_boxscores_scd2.sql\n-- =======================\n\n-- SCD Type 2 logic for player boxscores\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row\n          if (player_id, season, game_id) repeats.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS field_goal_percentage,\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.three_point_field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS three_point_field_goal_percentage,\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.free_throw_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS free_throw_percentage,\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_scd_uk,\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n-- =====================================================================\n-- Only change: select the SCD2 columns explicitly for final output\n-- =====================================================================\n\nSELECT\n    player_scd_uk,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    row_hash,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n    )", "name": "SQLQuery", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.581778Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:34:23.588359Z"}}
{"data": {"elapsed": 116.64993, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_113839_00039_4bm94", "status": "CREATE TABLE (1_498_773 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "SQL status: CREATE TABLE (1_498_773 rows) in 116.650 seconds", "name": "SQLQueryStatus", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.679208Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.704745Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.717819Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"", "name": "SQLQuery", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.722537Z"}}
{"data": {"elapsed": 0.06026268, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114035_00040_4bm94", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "SQL status: DROP VIEW in 0.060 seconds", "name": "SQLQueryStatus", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.789245Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.805369Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )", "name": "SQLQuery", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:19.812111Z"}}
{"data": {"elapsed": 10.679048, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114035_00041_4bm94", "status": "DELETE (0 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "SQL status: DELETE (0 rows) in 10.679 seconds", "name": "SQLQueryStatus", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.334563Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.354401Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        SELECT\n            season_id,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            game_id,\n            game_date,\n            matchup,\n            win_loss,\n            minutes_played,\n            field_goals_made,\n            field_goals_attempted,\n            field_goal_percentage,\n            three_point_field_goals_made,\n            three_point_field_goals_attempted,\n            three_point_field_goal_percentage,\n            free_throws_made,\n            free_throws_attempted,\n            free_throw_percentage,\n            offensive_rebounds,\n            defensive_rebounds,\n            rebounds,\n            assists,\n            steals,\n            blocks,\n            turnovers,\n            personal_fouls,\n            points,\n            plus_minus,\n            fantasy_points,\n            video_available,\n            season,\n            season_type,\n            year,\n            month,\n            day,\n            home_team,\n            away_team,\n            row_hash,\n            player_scd_uk,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        SELECT\n            season_id,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            game_id,\n            game_date,\n            matchup,\n            win_loss,\n            minutes_played,\n            field_goals_made,\n            field_goals_attempted,\n            field_goal_percentage,\n            three_point_field_goals_made,\n            three_point_field_goals_attempted,\n            three_point_field_goal_percentage,\n            free_throws_made,\n            free_throws_attempted,\n            free_throw_percentage,\n            offensive_rebounds,\n            defensive_rebounds,\n            rebounds,\n            assists,\n            steals,\n            blocks,\n            turnovers,\n            personal_fouls,\n            points,\n            plus_minus,\n            fantasy_points,\n            video_available,\n            season,\n            season_type,\n            year,\n            month,\n            day,\n            home_team,\n            away_team,\n            row_hash,\n            player_scd_uk,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp", "name": "SQLQuery", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.359521Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250506_114046_00042_4bm94", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Trino adapter: Trino query id: 20250506_114046_00042_4bm94", "name": "AdapterEventDebug", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.592809Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)", "name": "AdapterEventDebug", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.596975Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: ROLLBACK", "name": "Rollback", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.601364Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: Close", "name": "ConnectionClosed", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.606064Z"}}
{"data": {"exc": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 629, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 196, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 90, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "name": "CatchableExceptionOnRun", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.614571Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd3", "execution_time": 127.4707, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T15:36:30.620006", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.dim_players_scd3  [\u001b[31mERROR\u001b[0m in 127.47s]", "name": "LogModelResult", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.626218Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T15:36:30.620006", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:34:23.138830", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "run_result": {"adapter_response": {}, "execution_time": 127.4707, "message": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:34:23.209723Z", "name": "compile", "started_at": "2025-05-06T15:34:23.159667Z"}, {"completed_at": "2025-05-06T15:36:30.600910Z", "name": "execute", "started_at": "2025-05-06T15:34:23.214417Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.dim_players_scd3", "name": "NodeFinished", "pid": 4853, "thread": "Thread-1", "ts": "2025-05-06T15:36:30.631941Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 127.4707, "message": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:34:23.209723Z", "name": "compile", "started_at": "2025-05-06T15:34:23.159667Z"}, {"completed_at": "2025-05-06T15:36:30.600910Z", "name": "execute", "started_at": "2025-05-06T15:34:23.214417Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.dim_players_scd3' to be skipped because of status 'error'.  Reason: Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql.", "name": "MarkSkippedChildren", "pid": 4853, "thread": "Thread-7", "ts": "2025-05-06T15:36:30.638472Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts  [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.648242Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.dim_players_scd3 ..................... [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.653948Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.659126Z"}}
{"data": {"msg": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "error", "msg": "  Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "name": "RunResultError", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.662753Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.668174Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.674015Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.677758Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.dim_players_scd3' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.681757Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.685845Z"}}
{"data": {"execution": " in 0 hours 2 minutes and 9.13 seconds", "execution_time": 129.12572, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 2 minutes and 9.13 seconds (129.13s).", "name": "FinishedRunningStats", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.690675Z"}}
{"data": {"elapsed_time": 129.12572, "generated_at": "2025-05-06T15:36:30Z", "results": [{"adapter_response": {}, "execution_time": 127.4707, "message": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:34:23.209723Z", "name": "compile", "started_at": "2025-05-06T15:34:23.159667Z"}, {"completed_at": "2025-05-06T15:36:30.600910Z", "name": "execute", "started_at": "2025-05-06T15:34:23.214417Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.696647Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.926954Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.946342Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.981120Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.985950Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.991135Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:30.995451Z"}}
{"data": {"msg": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "error", "msg": "  Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114046_00042_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "name": "RunResultError", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:31.001652Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "", "name": "Formatting", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:31.007770Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:31.012796Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 143.67792, "process_in_blocks": "0", "process_kernel_time": 1.328093, "process_mem_max_rss": "125088", "process_out_blocks": "8", "process_user_time": 8.530444}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 143.67792, \"process_in_blocks\": \"0\", \"process_kernel_time\": 1.328093, \"process_mem_max_rss\": \"125088\", \"process_out_blocks\": \"8\", \"process_user_time\": 8.530444}", "name": "ResourceReport", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:31.020172Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T15:36:31.025417Z", "elapsed": 143.68437, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Command `dbt run` failed at 15:36:31.025417 after 143.68 seconds", "name": "CommandCompleted", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:31.026002Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "867a2e82-225f-4c40-924b-09ba0b9810e7", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 4853, "thread": "MainThread", "ts": "2025-05-06T15:36:31.030318Z"}}
{"data": {"log_version": 3, "version": "=1.9.4"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "Running with dbt=1.9.4", "name": "MainReportVersion", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:03.441908Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "False", "fail_fast": "True", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --models dim_players_scd3 --fail-fast --full-refresh --debug --log-format=json", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptions(include=[], exclude=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'True', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models dim_players_scd3 --fail-fast --full-refresh --debug --log-format=json', 'log_format': 'json', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}", "name": "MainReportArgs", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:03.453897Z"}}
{"data": {"adapter_name": "trino", "adapter_version": "=1.9.1"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "Registered adapter: trino=1.9.1", "name": "AdapterRegistered", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:04.408890Z"}}
{"data": {"checksum": "b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c", "profile": "", "target": "", "vars": "{}", "version": "1.9.4"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4", "name": "StateCheckVarsHash", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:04.815828Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:14.586996Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:14.590551Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.200960Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.215979Z"}}
{"data": {"stat_line": "13 models, 34 data tests, 837 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "Found 13 models, 34 data tests, 837 macros", "name": "FoundStats", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.270446Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.278737Z"}}
{"data": {"node_count": 1, "num_threads": 4, "target_name": "dev_trino"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "Concurrency: 4 threads (target='dev_trino')", "name": "ConcurrencyLine", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.284591Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.290888Z"}}
{"data": {"conn_name": "master", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Acquiring new trino connection 'master'", "name": "NewConnection", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:15.295394Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg'", "name": "NewConnection", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.304589Z"}}
{"data": {"conn_name": "list_iceberg", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"list_iceberg\"", "name": "ConnectionUsed", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.436704Z"}}
{"data": {"conn_name": "list_iceberg", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg\"} */\n\n    select schema_name\n    from \"iceberg\".INFORMATION_SCHEMA.schemata", "name": "SQLQuery", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.440811Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.445589Z"}}
{"data": {"description": "SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.", "docs_url": "https://docs.getdbt.com/reference/global-configs/behavior-changes", "flag_name": "require_certificate_validation", "flag_source": "dbt.adapters.base.impl"}, "info": {"category": "", "code": "D018", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.\nYou may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.\nVisit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.", "name": "BehaviorChangeEvent", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.449877Z"}}
{"data": {"elapsed": 0.11334481, "query_id": "20250506_114232_00043_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: SUCCESS in 0.113 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.558927Z"}}
{"data": {"conn_name": "list_iceberg"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg: Close", "name": "ConnectionClosed", "pid": 4965, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-05-06T15:38:15.565311Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "orig_conn_name": "list_iceberg"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_iceberg_nba_player_boxscores)", "name": "ConnectionReused", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:15.592470Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Acquiring new trino connection 'list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "NewConnection", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:15.595645Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores\"", "name": "ConnectionUsed", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:15.708957Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "conn_type": "trino"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"", "name": "ConnectionUsed", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:15.707589Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores'", "name": "SQLQuery", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:15.714094Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"connection_name\": \"list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts\"} */\nselect\n      t.table_catalog as database,\n      t.table_name as name,\n      t.table_schema as schema,\n      case when mv.name is not null then 'materialized_view'\n           when t.table_type = 'BASE TABLE' then 'table'\n           when t.table_type = 'VIEW' then 'view'\n           else t.table_type\n      end as table_type\n    from \"iceberg\".INFORMATION_SCHEMA.tables t\n    left join (\n            select * from system.metadata.materialized_views\n            where catalog_name = 'iceberg'\n              and schema_name = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts') mv\n          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name\n    where t.table_schema = 'iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts'", "name": "SQLQuery", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:15.717850Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:15.722299Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:15.726636Z"}}
{"data": {"elapsed": 0.29344913, "query_id": "20250506_114232_00044_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: SUCCESS in 0.293 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:16.015705Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: ROLLBACK", "name": "Rollback", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:16.025079Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores: Close", "name": "ConnectionClosed", "pid": 4965, "thread": "ThreadPoolExecutor-2_0", "ts": "2025-05-06T15:38:16.035078Z"}}
{"data": {"elapsed": 0.32741582, "query_id": "20250506_114232_00045_4bm94", "status": "SUCCESS"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: SUCCESS in 0.327 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:16.054094Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: ROLLBACK", "name": "Rollback", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:16.064444Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts: Close", "name": "ConnectionClosed", "pid": 4965, "thread": "ThreadPoolExecutor-2_1", "ts": "2025-05-06T15:38:16.077613Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:38:16.094737Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Began running node model.nba_team_stats_project.dim_players_scd3", "name": "NodeStart", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.126587Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd3", "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "started", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "1 of 1 START sql incremental model iceberg_nba_player_boxscores.dim_players_scd3  [RUN]", "name": "LogStartLine", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.135646Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "orig_conn_name": "list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_iceberg_iceberg_nba_player_boxscores_iceberg_nba_player_boxscores_texts, now model.nba_team_stats_project.dim_players_scd3)", "name": "ConnectionReused", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.142353Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Began compiling node model.nba_team_stats_project.dim_players_scd3", "name": "NodeCompiling", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.149775Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Writing injected SQL for node \"model.nba_team_stats_project.dim_players_scd3\"", "name": "WritingInjectedSQLForNode", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.200406Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Began executing node model.nba_team_stats_project.dim_players_scd3", "name": "NodeExecuting", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.225663Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd3\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Writing runtime sql for node \"model.nba_team_stats_project.dim_players_scd3\"", "name": "JinjaLogDebug", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.486969Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.599234Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"\n      \n      \n    as (\n      -- =======================\n-- player_boxscores_scd2.sql\n-- =======================\n\n-- SCD Type 2 logic for player boxscores\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row\n          if (player_id, season, game_id) repeats.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS field_goal_percentage,\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.three_point_field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS three_point_field_goal_percentage,\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.free_throw_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS free_throw_percentage,\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_scd_uk,\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n-- =====================================================================\n-- Only change: select the SCD2 columns explicitly for final output\n-- =====================================================================\n\nSELECT\n    player_scd_uk,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    row_hash,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n    )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n  \n    \n\n    create table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"\n      \n      \n    as (\n      -- =======================\n-- player_boxscores_scd2.sql\n-- =======================\n\n-- SCD Type 2 logic for player boxscores\n\n\nWITH raw AS (\n    /*\n       1) Pull all columns from the ephemeral \"player_boxscores\" view.\n    */\n    SELECT\n        season_id,\n        player_id,\n        player_name,\n        team_id,\n        team_abbreviation,\n        team_name,\n        game_id,\n        game_date,\n        matchup,\n        win_loss,\n        minutes_played,\n        field_goals_made,\n        field_goals_attempted,\n        field_goal_percentage,\n        three_point_field_goals_made,\n        three_point_field_goals_attempted,\n        three_point_field_goal_percentage,\n        free_throws_made,\n        free_throws_attempted,\n        free_throw_percentage,\n        offensive_rebounds,\n        defensive_rebounds,\n        rebounds,\n        assists,\n        steals,\n        blocks,\n        turnovers,\n        personal_fouls,\n        points,\n        plus_minus,\n        fantasy_points,\n        video_available,\n        season,\n        season_type,\n        year,\n        month,\n        day\n    FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"player_boxscores\"\n),\n\ndeduplicated AS (\n    /*\n       2) Use row_number() to pick exactly one row\n          if (player_id, season, game_id) repeats.\n    */\n    SELECT *\n    FROM (\n        SELECT\n            r.*,\n            ROW_NUMBER() OVER (\n                PARTITION BY\n                    player_id,\n                    season,\n                    game_id\n                ORDER BY\n                    game_date DESC\n            ) AS rn\n        FROM raw r\n    ) t\n    WHERE rn = 1\n),\n\nwith_home_away AS (\n    SELECT\n        d.*,\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 2))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 1))\n            ELSE NULL\n        END AS home_team,\n\n        CASE\n            WHEN d.matchup LIKE '%@%' THEN TRIM(SPLIT_PART(d.matchup, '@', 1))\n            WHEN d.matchup LIKE '%vs.%' THEN TRIM(SPLIT_PART(d.matchup, 'vs.', 2))\n            ELSE NULL\n        END AS away_team\n    FROM deduplicated d\n),\n\nhash_calc AS (\n    SELECT\n        w.*,\n        MD5(\n          to_utf8(\n            CONCAT(\n              COALESCE(CAST(w.player_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.team_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.player_name, '_null_'), '-',\n              COALESCE(w.team_abbreviation, '_null_'), '-',\n              COALESCE(w.team_name, '_null_'), '-',\n              COALESCE(CAST(w.game_date AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.season_id AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.game_id AS VARCHAR), '_null_'), '-',\n              COALESCE(w.matchup, '_null_'), '-',\n              COALESCE(w.win_loss, '_null_'), '-',\n              COALESCE(CAST(w.minutes_played AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goals_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.three_point_field_goal_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_made AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throws_attempted AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.free_throw_percentage AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.offensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.defensive_rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.rebounds AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.assists AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.steals AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.blocks AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.turnovers AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.personal_fouls AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.plus_minus AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.fantasy_points AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.video_available AS VARCHAR), '_null_'), '-',\n              COALESCE(w.season_type, '_null_'), '-',\n              COALESCE(CAST(w.year AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.month AS VARCHAR), '_null_'), '-',\n              COALESCE(CAST(w.day AS VARCHAR), '_null_'), '-',\n              COALESCE(w.home_team, '_null_'), '-',\n              COALESCE(w.away_team, '_null_')\n            )\n          )\n        ) AS row_hash\n    FROM with_home_away w\n),\n\nplayer_team_intervals AS (\n    SELECT\n        h.*,\n        CASE\n            WHEN LAG(team_id) OVER (PARTITION BY player_id ORDER BY game_date) = team_id\n            THEN 0\n            ELSE 1\n        END AS new_team_flag\n    FROM hash_calc h\n),\n\nplayer_team_blocks AS (\n    SELECT\n        i.*,\n        SUM(new_team_flag) OVER (\n            PARTITION BY player_id\n            ORDER BY game_date\n            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n        ) AS team_block\n    FROM player_team_intervals i\n),\n\nblock_date_ranges AS (\n    SELECT\n        b.*,\n        MIN(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_debut_date,\n        MAX(game_date) OVER (\n            PARTITION BY player_id, team_block\n        ) AS block_final_date\n    FROM player_team_blocks b\n),\n\nfinal_data AS (\n    SELECT\n        b.season_id,\n        b.player_id,\n        b.player_name,\n        b.team_id,\n        b.team_abbreviation,\n        b.team_name,\n        b.game_id,\n        b.game_date,\n        b.matchup,\n        b.win_loss,\n        b.minutes_played,\n        b.field_goals_made,\n        b.field_goals_attempted,\n        CASE\n            WHEN b.field_goal_percentage IS NULL THEN 0\n            WHEN b.field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS field_goal_percentage,\n        b.three_point_field_goals_made,\n        b.three_point_field_goals_attempted,\n        CASE\n            WHEN b.three_point_field_goal_percentage IS NULL THEN 0\n            WHEN b.three_point_field_goal_percentage = 1.0 THEN 100.0\n            WHEN b.three_point_field_goal_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.three_point_field_goal_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS three_point_field_goal_percentage,\n        b.free_throws_made,\n        b.free_throws_attempted,\n        CASE\n            WHEN b.free_throw_percentage IS NULL THEN 0\n            WHEN b.free_throw_percentage = 1.0 THEN 100.0\n            WHEN b.free_throw_percentage = 0 THEN 0\n            ELSE (CAST(FLOOR((b.free_throw_percentage*1000.0)+0.5) AS DOUBLE)/1000.0)\n        END AS free_throw_percentage,\n        b.offensive_rebounds,\n        b.defensive_rebounds,\n        b.rebounds,\n        b.assists,\n        b.steals,\n        b.blocks,\n        b.turnovers,\n        b.personal_fouls,\n        b.points,\n        COALESCE(b.plus_minus, 0) AS plus_minus,\n        b.fantasy_points,\n        b.video_available,\n        b.season,\n        b.season_type,\n        b.year,\n        b.month,\n        b.day,\n        b.home_team,\n        b.away_team,\n        b.row_hash,\n        CONCAT(\n            CAST(b.player_id AS VARCHAR), '_',\n            b.season, '_',\n            b.game_id\n        ) AS player_scd_uk,\n        b.block_debut_date AS debut_date,\n        b.block_final_date AS final_date,\n        CASE\n            WHEN b.block_final_date = b.game_date\n                 AND b.block_final_date = (\n                     SELECT MAX(game_date) FROM raw WHERE player_id = b.player_id\n                   )\n            THEN TRUE\n            ELSE FALSE\n        END AS is_current,\n        CURRENT_TIMESTAMP AS record_created_timestamp,\n        CURRENT_TIMESTAMP AS record_updated_timestamp,\n        'dbt_scd2' AS record_updated_by\n    FROM block_date_ranges b\n)\n\n-- =====================================================================\n-- Only change: select the SCD2 columns explicitly for final output\n-- =====================================================================\n\nSELECT\n    player_scd_uk,\n    player_id,\n    player_name,\n    team_id,\n    team_abbreviation,\n    team_name,\n    row_hash,\n    debut_date,\n    final_date,\n    is_current,\n    record_created_timestamp,\n    record_updated_timestamp,\n    record_updated_by\nFROM final_data\n\n    )", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.612014Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:38:16.620884Z"}}
{"data": {"elapsed": 47.90028, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114233_00046_4bm94", "status": "CREATE TABLE (1_498_773 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: CREATE TABLE (1_498_773 rows) in 47.900 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:03.416497Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:03.441963Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_backup\"", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:03.446417Z"}}
{"data": {"elapsed": 0.42173424, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114321_00047_4bm94", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.422 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:03.872603Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:03.888068Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\nalter table \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\" rename to \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:03.893195Z"}}
{"data": {"elapsed": 0.33876947, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114321_00048_4bm94", "status": "RENAME TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: RENAME TABLE in 0.339 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:04.236310Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_backup\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_backup\"", "name": "JinjaLogDebug", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:04.276173Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:04.285849Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_backup\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n    drop table if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_backup\"", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:04.290120Z"}}
{"data": {"elapsed": 2.7731168, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114322_00049_4bm94", "status": "DROP TABLE"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: DROP TABLE in 2.773 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.070215Z"}}
{"data": {"msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Applying DROP to: \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"", "name": "JinjaLogDebug", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.084760Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.091318Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n    drop view if exists \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3__dbt_tmp\"", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.097006Z"}}
{"data": {"elapsed": 0.039981756, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114325_00050_4bm94", "status": "DROP VIEW"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: DROP VIEW in 0.040 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.141493Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.153383Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        DELETE FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        WHERE player_scd_uk IN (\n            SELECT player_scd_uk\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )\n        AND row_hash NOT IN (\n            SELECT row_hash\n            FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp\n        )", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:07.157492Z"}}
{"data": {"elapsed": 8.734093, "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "query_id": "20250506_114325_00051_4bm94", "status": "DELETE (0 rows)"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "SQL status: DELETE (0 rows) in 8.734 seconds", "name": "SQLQueryStatus", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:15.896841Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "conn_type": "trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Using trino connection \"model.nba_team_stats_project.dim_players_scd3\"", "name": "ConnectionUsed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:15.920091Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        SELECT\n            season_id,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            game_id,\n            game_date,\n            matchup,\n            win_loss,\n            minutes_played,\n            field_goals_made,\n            field_goals_attempted,\n            field_goal_percentage,\n            three_point_field_goals_made,\n            three_point_field_goals_attempted,\n            three_point_field_goal_percentage,\n            free_throws_made,\n            free_throws_attempted,\n            free_throw_percentage,\n            offensive_rebounds,\n            defensive_rebounds,\n            rebounds,\n            assists,\n            steals,\n            blocks,\n            turnovers,\n            personal_fouls,\n            points,\n            plus_minus,\n            fantasy_points,\n            video_available,\n            season,\n            season_type,\n            year,\n            month,\n            day,\n            home_team,\n            away_team,\n            row_hash,\n            player_scd_uk,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: /* {\"app\": \"dbt\", \"dbt_version\": \"1.9.4\", \"profile_name\": \"nba_iceberg_profile\", \"target_name\": \"dev_trino\", \"node_id\": \"model.nba_team_stats_project.dim_players_scd3\"} */\n\n        INSERT INTO \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"\n        SELECT\n            season_id,\n            player_id,\n            player_name,\n            team_id,\n            team_abbreviation,\n            team_name,\n            game_id,\n            game_date,\n            matchup,\n            win_loss,\n            minutes_played,\n            field_goals_made,\n            field_goals_attempted,\n            field_goal_percentage,\n            three_point_field_goals_made,\n            three_point_field_goals_attempted,\n            three_point_field_goal_percentage,\n            free_throws_made,\n            free_throws_attempted,\n            free_throw_percentage,\n            offensive_rebounds,\n            defensive_rebounds,\n            rebounds,\n            assists,\n            steals,\n            blocks,\n            turnovers,\n            personal_fouls,\n            points,\n            plus_minus,\n            fantasy_points,\n            video_available,\n            season,\n            season_type,\n            year,\n            month,\n            day,\n            home_team,\n            away_team,\n            row_hash,\n            player_scd_uk,\n            debut_date,\n            final_date,\n            is_current,\n            record_created_timestamp,\n            record_updated_timestamp,\n            record_updated_by\n        FROM \"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"__dbt_tmp", "name": "SQLQuery", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:15.924410Z"}}
{"data": {"args": [], "base_msg": "Trino query id: 20250506_114333_00052_4bm94", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Trino adapter: Trino query id: 20250506_114333_00052_4bm94", "name": "AdapterEventDebug", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.166748Z"}}
{"data": {"args": [], "base_msg": "Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)", "name": "Trino", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)", "name": "AdapterEventDebug", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.171781Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: ROLLBACK", "name": "Rollback", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.176434Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3", "node_info": {"materialized": "incremental", "meta": {}, "node_checksum": "", "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On model.nba_team_stats_project.dim_players_scd3: Close", "name": "ConnectionClosed", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.180342Z"}}
{"data": {"exc": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "exc_info": "Traceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 443, in exception_handler\n    yield\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 147, in add_query\n    _execute_query_with_retry(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 97, in _execute_query_with_retry\n    cursor.execute(sql, bindings)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 393, in execute\n    result = self._cursor.execute(sql, params=bindings)\n  File \"/usr/local/lib/python3.9/site-packages/trino/dbapi.py\", line 629, in execute\n    self._iterator = iter(self._query.execute())\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 900, in execute\n    self._result.rows += self.fetch()\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 920, in fetch\n    status = self._request.process(response)\n  File \"/usr/local/lib/python3.9/site-packages/trino/client.py\", line 689, in process\n    raise self._process_error(response[\"error\"], response.get(\"id\"))\ntrino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 361, in safe_run\n    result = self.compile_and_execute(manifest, ctx)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 308, in compile_and_execute\n    result = self.run(ctx.node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/base.py\", line 408, in run\n    return self.execute(compiled_node, manifest)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 334, in execute\n    return self._execute_model(hook_ctx, context_config, model, context, materialization_macro)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/task/run.py\", line 294, in _execute_model\n    result = MacroGenerator(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 196, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 90, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/clients/jinja.py\", line 82, in __call__\n    return self.call_macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/clients/jinja.py\", line 395, in call_macro\n    return macro(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 770, in __call__\n    return self._invoke(arguments, autoescape)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 784, in _invoke\n    rv = self._func(*arguments)\n  File \"<template>\", line 52, in macro\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/sandbox.py\", line 401, in call\n    return __context.call(__obj, *args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/jinja2/runtime.py\", line 303, in call\n    return __obj(*args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt_common/record.py\", line 507, in record_replay_wrapper\n    return func_to_record(*call_args, **kwargs)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/base/impl.py\", line 438, in execute\n    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 218, in execute\n    _, cursor = self.add_query(sql, auto_begin)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 561, in add_query\n    connection, cursor = parent.add_query(\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/sql/connections.py\", line 167, in add_query\n    return connection, cursor\n  File \"/usr/local/lib/python3.9/contextlib.py\", line 137, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"/usr/local/lib/python3.9/site-packages/dbt/adapters/trino/connections.py\", line 454, in exception_handler\n    raise DbtDatabaseError(msg)\ndbt_common.exceptions.base.DbtDatabaseError: Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql\n", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "executing", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "W002", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "name": "CatchableExceptionOnRun", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.190213Z"}}
{"data": {"description": "sql incremental model iceberg_nba_player_boxscores.dim_players_scd3", "execution_time": 60.05374, "index": 1, "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T15:39:16.195229", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "status": "error", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "error", "msg": "1 of 1 ERROR creating sql incremental model iceberg_nba_player_boxscores.dim_players_scd3  [\u001b[31mERROR\u001b[0m in 60.05s]", "name": "LogModelResult", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.200808Z"}}
{"data": {"node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "2025-05-06T15:39:16.195229", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "2025-05-06T15:38:16.126009", "node_status": "error", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "run_result": {"adapter_response": {}, "execution_time": 60.05374, "message": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:38:16.225154Z", "name": "compile", "started_at": "2025-05-06T15:38:16.155292Z"}, {"completed_at": "2025-05-06T15:39:16.176037Z", "name": "execute", "started_at": "2025-05-06T15:38:16.231464Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Finished running node model.nba_team_stats_project.dim_players_scd3", "name": "NodeFinished", "pid": 4965, "thread": "Thread-1", "ts": "2025-05-06T15:39:16.206988Z"}}
{"data": {"run_result": {"adapter_response": {}, "execution_time": 60.05374, "message": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:38:16.225154Z", "name": "compile", "started_at": "2025-05-06T15:38:16.155292Z"}, {"completed_at": "2025-05-06T15:39:16.176037Z", "name": "execute", "started_at": "2025-05-06T15:38:16.231464Z"}]}, "status": "error", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}, "info": {"category": "", "code": "Z033", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Marking all children of 'model.nba_team_stats_project.dim_players_scd3' to be skipped because of status 'error'.  Reason: Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql.", "name": "MarkSkippedChildren", "pid": 4965, "thread": "Thread-7", "ts": "2025-05-06T15:39:16.212639Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "error", "msg": "CANCEL query list_iceberg_iceberg_nba_player_boxscores ......................... [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.220477Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3"}, "info": {"category": "", "code": "Q022", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "error", "msg": "CANCEL query model.nba_team_stats_project.dim_players_scd3 ..................... [\u001b[31mCANCEL\u001b[0m]", "name": "LogCancelLine", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.224827Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.229093Z"}}
{"data": {"msg": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "error", "msg": "  Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "name": "RunResultError", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.232845Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.238210Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.242638Z"}}
{"data": {"conn_name": "list_iceberg_iceberg_nba_player_boxscores"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Connection 'list_iceberg_iceberg_nba_player_boxscores' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.246217Z"}}
{"data": {"conn_name": "model.nba_team_stats_project.dim_players_scd3"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Connection 'model.nba_team_stats_project.dim_players_scd3' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.250478Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.256107Z"}}
{"data": {"execution": " in 0 hours 1 minutes and 0.96 seconds", "execution_time": 60.961502, "stat_line": "1 incremental model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "Finished running 1 incremental model in 0 hours 1 minutes and 0.96 seconds (60.96s).", "name": "FinishedRunningStats", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.260151Z"}}
{"data": {"elapsed_time": 60.961502, "generated_at": "2025-05-06T15:39:16Z", "results": [{"adapter_response": {}, "execution_time": 60.05374, "message": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "num_failures": 0, "status": "error", "thread": "Thread-1", "timing_info": [{"completed_at": "2025-05-06T15:38:16.225154Z", "name": "compile", "started_at": "2025-05-06T15:38:16.155292Z"}, {"completed_at": "2025-05-06T15:39:16.176037Z", "name": "execute", "started_at": "2025-05-06T15:38:16.231464Z"}]}], "success": false}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.265014Z"}}
{"data": {"artifact_path": "/dbt/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Wrote artifact WritableManifest to /dbt/target/manifest.json", "name": "ArtifactWritten", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.487657Z"}}
{"data": {"artifact_path": "/dbt/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Wrote artifact SemanticManifest to /dbt/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.502Z"}}
{"data": {"artifact_path": "/dbt/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /dbt/target/run_results.json", "name": "ArtifactWritten", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.552924Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.557976Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 1, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "\u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m", "name": "EndOfRunSummary", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.563135Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.568483Z"}}
{"data": {"msg": "Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "node_info": {"materialized": "incremental", "meta": {}, "node_finished_at": "", "node_name": "dim_players_scd3", "node_path": "dim_players_scd3.sql", "node_relation": {"alias": "dim_players_scd3", "database": "iceberg", "relation_name": "\"iceberg\".\"iceberg_nba_player_boxscores\".\"dim_players_scd3\"", "schema": "iceberg_nba_player_boxscores"}, "node_started_at": "", "node_status": "None", "resource_type": "model", "unique_id": "model.nba_team_stats_project.dim_players_scd3"}}, "info": {"category": "", "code": "Z024", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "error", "msg": "  Database Error in model dim_players_scd3 (NBA_models/dim_players_scd3.sql)\n  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message=\"line 5:13: Column 'season_id' cannot be resolved\", query_id=20250506_114333_00052_4bm94)\n  compiled code at target/run/nba_team_stats_project/NBA_models/dim_players_scd3.sql", "name": "RunResultError", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.574174Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "", "name": "Formatting", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.580580Z"}}
{"data": {"stats": {"error": 1, "pass": 0, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "info", "msg": "Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1", "name": "StatsLine", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.585913Z"}}
{"data": {"command_name": "run", "command_success": false, "command_wall_clock_time": 74.44842, "process_in_blocks": "8", "process_kernel_time": 1.485437, "process_mem_max_rss": "121728", "process_out_blocks": "8", "process_user_time": 6.548051}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": false, \"command_wall_clock_time\": 74.44842, \"process_in_blocks\": \"8\", \"process_kernel_time\": 1.485437, \"process_mem_max_rss\": \"121728\", \"process_out_blocks\": \"8\", \"process_user_time\": 6.548051}", "name": "ResourceReport", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.593147Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-05-06T15:39:16.598534Z", "elapsed": 74.45486, "success": false}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Command `dbt run` failed at 15:39:16.598534 after 74.45 seconds", "name": "CommandCompleted", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.599293Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "9222bc71-2dd7-445b-81eb-25df15ff4864", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 4965, "thread": "MainThread", "ts": "2025-05-06T15:39:16.604288Z"}}
{"data": {"log_version": 3, "version": "=1.10.19"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "d691c192-4ecb-4084-853e-76089b5cba1f", "level": "info", "msg": "Running with dbt=1.10.19", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2026-02-06T23:05:08.716719Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "d691c192-4ecb-4084-853e-76089b5cba1f", "level": "debug", "msg": "running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'False', 'profiles_dir': '/dbt', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'debug': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/dbt/logs', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'json', 'quiet': 'False', 'static_parser': 'True'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2026-02-06T23:05:09.081943Z"}}
{"data": {"log_version": 3, "version": "=1.10.19"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9088c1c4-4f7c-4dc2-945d-e5725dcba65d", "level": "info", "msg": "Running with dbt=1.10.19", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2026-02-07T01:34:22.603364Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9088c1c4-4f7c-4dc2-945d-e5725dcba65d", "level": "debug", "msg": "running dbt with arguments {'log_format': 'json', 'use_experimental_parser': 'False', 'profiles_dir': '/dbt', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/dbt/logs', 'indirect_selection': 'eager', 'warn_error': 'None', 'empty': 'None', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'send_anonymous_usage_stats': 'False', 'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'debug': 'True', 'printer_width': '80'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2026-02-07T01:34:22.912784Z"}}
{"data": {"log_version": 3, "version": "=1.10.19"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "55fd0e15-1ec6-4867-bb89-09ac0719a1e2", "level": "info", "msg": "Running with dbt=1.10.19", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2026-02-07T03:54:16.757147Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "55fd0e15-1ec6-4867-bb89-09ac0719a1e2", "level": "debug", "msg": "running dbt with arguments {'log_path': '/dbt/logs', 'send_anonymous_usage_stats': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'debug': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'json', 'use_colors': 'True', 'profiles_dir': '/dbt', 'indirect_selection': 'eager', 'introspect': 'True'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2026-02-07T03:54:17.555073Z"}}
{"data": {"log_version": 3, "version": "=1.10.19"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "c6832385-a96b-4c13-b7ee-55f8eead7f1d", "level": "info", "msg": "Running with dbt=1.10.19", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2026-02-21T13:55:36.311611Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "c6832385-a96b-4c13-b7ee-55f8eead7f1d", "level": "debug", "msg": "running dbt with arguments {'log_format': 'json', 'quiet': 'False', 'log_path': '/dbt/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/dbt', 'send_anonymous_usage_stats': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'introspect': 'True', 'printer_width': '80', 'empty': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2026-02-21T13:55:36.429644Z"}}
{"data": {"log_version": 3, "version": "=1.10.19"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "9435271f-e224-4876-9237-3eabb8c3f2a0", "level": "info", "msg": "Running with dbt=1.10.19", "name": "MainReportVersion", "pid": 1, "thread": "MainThread", "ts": "2026-02-21T15:16:46.732685Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "True", "empty": "None", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt docs serve --port 8585 --no-browser", "log_cache_events": "False", "log_format": "json", "log_path": "/dbt/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/dbt", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "9435271f-e224-4876-9237-3eabb8c3f2a0", "level": "debug", "msg": "running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'debug': 'True', 'empty': 'None', 'partial_parse': 'True', 'profiles_dir': '/dbt', 'log_format': 'json', 'log_path': '/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --port 8585 --no-browser', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}", "name": "MainReportArgs", "pid": 1, "thread": "MainThread", "ts": "2026-02-21T15:16:46.859127Z"}}
